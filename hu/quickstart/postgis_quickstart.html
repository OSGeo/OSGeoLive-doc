
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="hu">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PostGIS gyorstalpaló &#8212; OSGeoLive 14.0 Documentation</title>
    <link rel="stylesheet" href="../../_static/overview.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '14.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Tárgymutató" href="../genindex.html" />
    <link rel="search" title="Keresés" href="../search.html" />
    <link rel="copyright" title="Minden jog fenntartva" href="../copyright.html" />
    <link rel="next" title="SpatiaLite" href="../overview/spatialite_overview.html" />
    <link rel="prev" title="PostGIS" href="../overview/postgis_overview.html" />
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>


  </head>
  <body>

        
        
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
    </div> 
        


    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a>
		</div>
	</font>
    </div>



    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="http://postgis.net"><img alt="../../_images/logo_postgis.png" class="align-right" src="../../_images/logo_postgis.png" /></a>
<a class="reference external image-reference" href="https://www.osgeo.org"><img alt="../../_images/OSGeo_project.png" class="align-right" src="../../_images/OSGeo_project.png" /></a>
<div class="section" id="postgis-quickstart">
<h1>PostGIS gyorstalpaló<a class="headerlink" href="#postgis-quickstart" title="Hivatkozás erre a fejezetcímre">¶</a></h1>
<p>A PostGIS a PostgreSQL adatbázist térinformatikai képességekkel bővíti. Kiterjeszti PostgreSQL-t, mely így térbeli adatokat tud tárolni, lekérdezni és manipulálni. Ebben a gyorstalpalóban  «PostgreSQL» -t használunk amikor az általános adatbázis funkciókat írjuk le és «PostGIS»-t, amikor a PostGIS által hozzáadott  térbeli funkcionalitást.</p>
<p>Ez a gyorstalpaló leírja:</p>
<blockquote>
<div><ul class="simple">
<li>Hogyan hozzunk létre és kérdezzünk le téradatbázist a parancssorból és a <a class="reference internal" href="../overview/qgis_overview.html"><span class="doc">QGIS</span></a> grafikus kliensből.</li>
<li>Hogyan kezeljük az adatokat a pgAdmin kliensből.</li>
</ul>
</div></blockquote>
<div class="contents local topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#client-server-architecture" id="id1">Kliens-szerver architektúra</a></li>
<li><a class="reference internal" href="#creating-a-spatially-enabled-database" id="id2">Téradatbázis létrehozása</a></li>
<li><a class="reference internal" href="#creating-a-spatial-table-using-sql" id="id3">Téradat tábla létrehozása SQL használatával</a></li>
<li><a class="reference internal" href="#simple-queries" id="id4">Egyszerű lekérdezések</a></li>
<li><a class="reference internal" href="#spatial-queries" id="id5">Térbeli lekérdezések</a></li>
<li><a class="reference internal" href="#mapping" id="id6">Térkép</a></li>
<li><a class="reference internal" href="#importing-spatial-data-into-the-database" id="id7">Téradatok importálása az adatbázisba</a></li>
<li><a class="reference internal" href="#get-to-know-pgadmin-iii" id="id8">Ismerjük meg a pgAdmin III-t</a></li>
<li><a class="reference internal" href="#executing-a-sql-query-from-pgadmin-iii" id="id9">Egy SQL lekérdezés végrehajtása a pgAdmin III-ból</a></li>
<li><a class="reference internal" href="#get-to-know-foreign-data-wrappers-fdw" id="id10">Get to know Foreign Data Wrappers (FDW)</a></li>
<li><a class="reference internal" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" id="id11">Connect to a remote OGR data source via ogr_fdw</a></li>
<li><a class="reference internal" href="#things-to-try" id="id12">Kipróbálandó dolgok</a></li>
<li><a class="reference internal" href="#what-next" id="id13">Mi a következő?</a></li>
</ul>
</div>
<div class="section" id="client-server-architecture">
<h2><a class="toc-backref" href="#id1">Kliens-szerver architektúra</a><a class="headerlink" href="#client-server-architecture" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>PostgreSQL, mint sok más adatbázis kliens-szerver rendszerként működik. A kliens egy kérést  küld a szervernek és egy választ kap vissza. Ez ugyanaz a mód, ahogy az internet működik - a böngésző a kliens és a webszerver weblapokat küld vissza. A PostgreSQL esetén a kérések  SQL nyelven készülnek és a válasz általában egy adattáblázat az adatbázisból.</p>
<p>Semmi sem akadályozza meg, hogy a szerver ugyanazon a számtógépen legyen mint a kliens, ez lehetővé teszi, hogy egy gépen használjuk a PostgreSQL-t. A kliense a belső «loopback» hálózati kapcsolaton keresztül kapcsolódik a szerverhez és más számítógépekről el sem érhető, hacsak nem konfigurálja úgy.</p>
</div>
<div class="section" id="creating-a-spatially-enabled-database">
<h2><a class="toc-backref" href="#id2">Téradatbázis létrehozása</a><a class="headerlink" href="#creating-a-spatially-enabled-database" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>A parancssori kliens a terminál emulátor ablakban fut.</p>
<p>Indítson egy terminál emulátort (LXTerminal ebben a verzióban) az Applications menüből az Accessories csoportból. Ez egy Unix burok parancs promptot ad. Írja be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">V</span>
</pre></div>
</div>
<p>és nyomja meg az entert, hogy lássa a PostgreSQL verziószámát.</p>
<p>Egyetlen PostgreSQL szerver lehetővé teszi a munkaszervezést az adatok külön adatbázisokba rendezésével. Minden egyes adatbázis egy önálló rendszer, saját táblákkal, nézet táblákkal, felhasználókkal és így tovább. Amikor csatlakozik egy PostgreSQL szerverhez meg kell adnia egy adatbázist.</p>
<p>A szerveren tárolt adatbázisok listáját a következő paranccsal kaphatja meg:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
<p>Számos adatbázist láthat, melyeket valamely a rendszeren lévő projekt használ. Egy újat fogunk létrehozni ehhez a gyorstalpalóhoz.</p>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">A lista a standard unix lapkezelőt használja - szóköz a következő laphoz,  <code class="kbd docutils literal"><span class="pre">b</span></code> a visszalépéshez, <code class="kbd docutils literal"><span class="pre">q</span></code> a kilépéshez, h a súgóhoz.</p>
</div>
<p>A PostgreSQL egy segédprogramot, <code class="docutils literal"><span class="pre">createdb</span></code> nyújt adatbázisok létrehozásához. Az adatbázist létre kell hozni mielőtt hozzáadnánk a PostGIS bővítményt. Az adatbázis neve legyen <code class="docutils literal"><span class="pre">demo</span></code>. Ezután a parancs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">createdb</span> <span class="n">demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">A parancssori eszközökhöz általában segítséget kaphatunk a <code class="docutils literal"><span class="pre">--help</span></code> opcióval.</p>
</div>
<p>Ha most a <code class="docutils literal"><span class="pre">psql</span> <span class="pre">-l</span></code> parancsot futtatja, látnia kell a <code class="docutils literal"><span class="pre">demo</span></code> adatbázist a listában. Még nem adtuk hozzá a PostGIS bővítményt, de a következő részben megtanuljuk ezt.</p>
<p>A PostGIS adatbázist az SQL nyelv használatával hozhat létre. Először töröljük az éppen létrehozott adatbázist a <code class="docutils literal"><span class="pre">dropdb</span></code> parancs használatával, majd használja a <code class="docutils literal"><span class="pre">psql</span></code> parancsot, hogy egy SQL parancs értelmezőt kapjunk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dropdb</span> <span class="n">demo</span>
<span class="n">psql</span> <span class="o">-</span><span class="n">d</span> <span class="n">postgres</span>
</pre></div>
</div>
<p>Ez a <code class="docutils literal"><span class="pre">postgres</span></code> nevű alap rendszer adatbázishoz csatlakozik. Most írja be az SQL parancsot az adatbázis létrehozásához:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># CREATE DATABASE demo;</span>
</pre></div>
</div>
<p>Most kapcsolódjunk a <code class="docutils literal"><span class="pre">postgres</span></code> adatbázisból az új <code class="docutils literal"><span class="pre">demo</span></code> adatbázishoz. A jövőben  közvetlenül csatlakoztathat hozzá a <code class="docutils literal"><span class="pre">psql</span> <span class="pre">-d</span> <span class="pre">demo</span></code> paranccsal, de itt van egy ügyes lehetőség a váltásra a <code class="docutils literal"><span class="pre">psql</span></code> parancssorból:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># \c demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">Nyomjon <code class="kbd docutils literal"><span class="pre">CTRL</span></code> + <code class="kbd docutils literal"><span class="pre">C</span></code>-t, ha a psql prompt jelenik meg a return megnyomása után. Ez törli a korábbi inputot és újrakezdheti. Valószínűleg egy záró idézőjelre, pontosvesszőre vagy valami másra vár.</p>
</div>
<p>Egy információ üzenetet kellene látnia és a prompt megváltozik, hogy mutassa most a <code class="docutils literal"><span class="pre">demo</span></code> adatbázishoz csatlakozik.</p>
<p>Ezután adja hozzá a PostGIS bővítményt:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># create extension postgis;</span>
</pre></div>
</div>
<p>A PostGIS telepítés ellenőrzéséhez futtassa a következő lekérdezést:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT postgis_version();</span>

           <span class="n">postgis_version</span>
<span class="o">---------------------------------------</span>
 <span class="mf">2.3</span> <span class="n">USE_GEOS</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_PROJ</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_STATS</span><span class="o">=</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>A PostGIS sok függvényt, egy táblát és több nézet táblát telepít.</p>
<p>Az adatbázisban lévő táblák listájához írja be a <code class="docutils literal"><span class="pre">\dt</span></code> parancsot. Valami hasonlót kellene látnia mint ez:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dt</span>
             <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>       <span class="o">|</span> <span class="n">Type</span>  <span class="o">|</span> <span class="n">Owner</span>
<span class="o">--------+------------------+-------+-------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">spatial_ref_sys</span>  <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">user</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>A PostGIS a <code class="docutils literal"><span class="pre">spatial_ref_sys</span></code> táblát a különböző vetületi rendszerek közötti transzformációnál használja. A <code class="docutils literal"><span class="pre">spatial_ref_sys</span></code> tábla a vetületekről tárol információkat és az SQL használhatjuk, hogy gyorsan belenézzünk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT srid, auth_name, proj4text FROM spatial_ref_sys LIMIT 10;</span>

 <span class="n">srid</span> <span class="o">|</span> <span class="n">auth_name</span> <span class="o">|</span>          <span class="n">proj4text</span>
<span class="o">------+-----------+--------------------------------------</span>
 <span class="mi">3819</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">towgs</span><span class="o">...</span>
 <span class="mi">3821</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">3824</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3889</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3906</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4001</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">airy</span> <span class="o">+</span><span class="n">no_defs</span><span class="o">...</span>
 <span class="mi">4002</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377340.189</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
 <span class="mi">4003</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">4004</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4005</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377492.018</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Ez igazolja, hogy téradatbázisunk van.</p>
<p>E tábla mellett több nézet táblát találhat, melyek a postgis engedélyezése során jöttek létre.</p>
<p>Írja be a <code class="docutils literal"><span class="pre">\dv</span></code> parancsot az adatbázisban található nézet táblák listájához. Valami ilyesmit kellene látnia:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dv</span>
                                                                <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>        <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span>  <span class="n">Owner</span>
<span class="o">--------+-------------------+------+----------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geography_columns</span> <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geometry_columns</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_columns</span>    <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_overviews</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
<span class="p">(</span><span class="mi">4</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>A PostGIS számos téradat típus támogat:</p>
<blockquote>
<div><p><cite>geometry</cite> - egy olyan adattípus, mely az adatokat egy síkon ábrázolt vektorrajzként tárolja</p>
<p><cite>geography</cite> - egy olyan adattípus, mely az adatokat egy gömbön ábrázolt vektorrajzként tárolja</p>
<dl class="docutils">
<dt><cite>raster</cite> - egy olyan adattípus, mely az adatokat n-dimenziós mátrixként tárolja, ahol minden pozíció (pixel) egy területet reprezentál</dt>
<dd>a térben és minden sáv (dimenzió) egy értékkel rendelkezik az egyes pixelekre.</dd>
</dl>
</div></blockquote>
<p>A <code class="docutils literal"><span class="pre">geometry_columns</span></code>, <code class="docutils literal"><span class="pre">geography_columns</span></code> és <code class="docutils literal"><span class="pre">raster_columns</span></code> nézettáblák feladat, hogy a PostGIS felé jelezzék mely táblákban van geometry, geography és raster oszlopokat.</p>
<p>Az overview-ek kisebb felbontású táblák a raszter adatokhoz. A <code class="docutils literal"><span class="pre">raster_overviews</span></code> tartalmazza a táblákat, a raszter oszlopokat és a táblákat, melyhez az áttekintők tartoznak.A raszter áttekintő táblákat olyan eszközök használják mint például a QGIS, hogy a kisebb felbontású raszter adatokat gyorsabban töltsék be.</p>
<p>A PostGIS geometry típus az első és még most is a legnépszerűbb típus melyet a PostGIS felhasználók használnak. A figyelmünket erre a típusra fókuszáljuk.</p>
</div>
<div class="section" id="creating-a-spatial-table-using-sql">
<h2><a class="toc-backref" href="#id3">Téradat tábla létrehozása SQL használatával</a><a class="headerlink" href="#creating-a-spatial-table-using-sql" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Most hogy van a téradatbázisunk létrehozhatunk néhány térbeli táblát.</p>
<p>Először hozzunk létre egy közönséges adatbázis táblát város adatok tárolásához. Ez a tábla három mezőt tartalmaz - egyet a város azonosító számának. egyet a városnévnek és egy másikat a geometry oszlophoz:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># CREATE TABLE cities ( id int4 primary key, name varchar(50), geom geometry(POINT,4326) );</span>
</pre></div>
</div>
<p>Hagyományosan a geometria oszlopot <code class="docutils literal"><span class="pre">geom</span></code>-nak nevezzük (a korábbi PostGIS konvenció a <code class="docutils literal"><span class="pre">the_geom</span></code> volt). Ez megadja a PostGIS-nek milyen típusú geometria tartozik az egyes elemekhez (pontok, törtvonalak, területek, stb.), hány dimenziósak (ebben az esetben 2, 3 vagy 4 dimenzióhoz a POINZ, POINTM vagy POINTZM kell használni) és megadja a vetületet. EPSG:4326 koordinátákat használunk a városokhoz.</p>
<p>Ha most ellenőrzi a cities táblát, láthatja az új oszlopot és azt az információt, hogy tábla aktuálisan egy sort sem tartalmaz.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * from cities;</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span> <span class="o">|</span> <span class="n">geom</span>
<span class="o">----+------+----------</span>
<span class="p">(</span><span class="mi">0</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>A sorok hozzáadásához SQL mondatokat fogunk használni. A geometry oszlop feltöltéséhez a PostGIS az <code class="docutils literal"><span class="pre">ST_GeomFromText</span></code> függvényét fogjuk használni, hogy a koordinátákat és a vetület azonosítót tartalmazó szöveges formátumból konvertáljuk:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (1,ST_GeomFromText(&#39;POINT(-0.1257 51.508)&#39;,4326),&#39;London, England&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (2,ST_GeomFromText(&#39;POINT(-81.233 42.983)&#39;,4326),&#39;London, Ontario&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (3,ST_GeomFromText(&#39;POINT(27.91162491 -33.01529)&#39;,4326),&#39;East London,SA&#39;);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">Használja a nyíl billentyűket korábbi parancsok elővételéhez és szerkesztéséhez.</p>
</div>
<p>Amint látja, ez nagyon gyorsan unalmassá válik. Szerencsére vannak más, sokkal könnyebb módszerek az adatok PostGIS táblákba juttatására. De most már van három város az adatbázisunkban, és dolgozhatunk azokkal.</p>
</div>
<div class="section" id="simple-queries">
<h2><a class="toc-backref" href="#id4">Egyszerű lekérdezések</a><a class="headerlink" href="#simple-queries" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Az összes szokásos SQL-művelet alkalmazható a PostGIS táblából származó adatok kiolvasásához:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span>                      <span class="n">geom</span>
<span class="o">----+-----------------+----------------------------------------------------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">BBB88D06F016C0BF1B2FDD2406C14940</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">F4FDD478E94E54C0E7FBA9F1D27D4540</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="mf">0101000020E610000040</span><span class="n">AB064060E93B4059FAD005F58140C0</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Ez a koordináták kódolt hexadecimális változatát adja nekünk, nem túl hasznos az embereknek.</p>
<p>Ha újra WKT formátumban  szeretne egy pillantást vetni a geometriára, akkor az ST_AsText(geom), vagy az ST_AsEwkt(geom) függvényeket használhatja. Az ST_X(geom),  az ST_Y(geom) függvényeket is használhatja  a koordináták numerikus értékének kiolvasásához:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT id, ST_AsText(geom), ST_AsEwkt(geom), ST_X(geom), ST_Y(geom) FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>          <span class="n">st_astext</span>           <span class="o">|</span>               <span class="n">st_asewkt</span>                <span class="o">|</span>    <span class="n">st_x</span>     <span class="o">|</span>   <span class="n">st_y</span>
<span class="o">----+------------------------------+----------------------------------------+-------------+-----------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">0.1257</span> <span class="o">|</span>    <span class="mf">51.508</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">81.233</span> <span class="o">|</span>    <span class="mf">42.983</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="mf">27.91162491</span> <span class="o">|</span> <span class="o">-</span><span class="mf">33.01529</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="spatial-queries">
<h2><a class="toc-backref" href="#id5">Térbeli lekérdezések</a><a class="headerlink" href="#spatial-queries" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>A PostGIS sok térbeli funkcionalitással rendelkező függvényt ad a PostgreSQL-hez. Már láttuk a ST_GeomFromText, mely WKT formátumátumot alakítja át geometriává. A legtöbb közülük  ST-vel (a térbeli típus) kezdődik, és a PostGIS dokumentáció egy fejezete sorolja fel őket. Most használjunk egyet egy gyakorlati kérdés megválaszolására - milyen messze van ez a három London egymástól méterben, feltételezve, hogy a föld gömb alakú?</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSphere(p1.geom,p2.geom) FROM cities AS p1, cities AS p2 WHERE p1.id &gt; p2.id;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancesphere</span>
<span class="o">-----------------+-----------------+--------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">5875766.85191657</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">9789646.96784908</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>   <span class="mf">13892160.9525778</span>
 <span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Ez méterben adja meg a távolságot minden város pár között. Nézze meg a «WHERE» részét a sornak, hogyan akadályozza meg, hogy a város távolságát önmagától (ami mind nulla lenne) és a visszafelé  távolságot (London, England-ből a távolság London, Ontario-ba ugyanaz mint London, Ontario-ból London, England-be)  is megkapjuk. Próbálja ki a WHERE rész nélkül és nézze meg mi történik.</p>
<p>Egy másik függvény segítségével a távolságot kiszámíthatjuk egy ellipszoidon is, ha megadjuk az ellipszoid nevét, a fél nagytengelyét és a lapultságát:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSpheroid(</span>
        <span class="n">p1</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span><span class="n">p2</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="s1">&#39;SPHEROID[&quot;GRS_1980&quot;,6378137,298.257222]&#39;</span>
        <span class="p">)</span>
       <span class="n">FROM</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p1</span><span class="p">,</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p2</span> <span class="n">WHERE</span> <span class="n">p1</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="o">.</span><span class="n">id</span><span class="p">;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancespheroid</span>
<span class="o">-----------------+-----------------+----------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">5892413.63776489</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">9756842.65711931</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>     <span class="mf">13884149.4140698</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>A PostgreSQL parancssorból kilépéshez írja be:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>\<span class="n">q</span>
</pre></div>
</div>
<p>Most visszatért a rendszer konzolhoz:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>user@osgeolive:~$
</pre></div>
</div>
</div>
<div class="section" id="mapping">
<h2><a class="toc-backref" href="#id6">Térkép</a><a class="headerlink" href="#mapping" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Az adatokat fogadni képes kliens szükséges a PostGIS adatokból térkép készítéshez. A legtöbb nyílt forráskódú asztali GIS meg tudja csinálni ezt - például a QGIS, a gvSIG, a uDIG. Most megmutatjuk hogyan készíthet térképet a QGIS-ből</p>
<p>Indítsa el a QGIS-t a Desktop GIS menüből és válassza az <code class="docutils literal"><span class="pre">Add</span> <span class="pre">PostGIS</span> <span class="pre">layers</span></code>-t (PostGIS réteg hozzáadás) a Layer (Réteg) menüből. A PostGIS-ban tárolt Natural Earth adatokhoz kapcsolódás paramétereit már beállítottuk a Connections (Kapcsolatok) legördülő listában. Itt új szerver kapcsolatokat adhat meg és tárolhatja a beállításokat a könnyű újrafelhasználáshoz. Kattintson a Connections (Kapcsolatok) legördülő listára és válassza a Natural Earth-t.Kattintson az <code class="docutils literal"><span class="pre">Edit</span></code> (Szerkeszt) gombra, ha meg akarja tekinteni a Natural Earth-höz tartozó paramétereket vagy egyszerűen kattintson a <code class="docutils literal"><span class="pre">Connect</span></code>-re (Kapcsolódás) gombra a folytatáshoz:</p>
<a class="reference internal image-reference" href="../../_images/postgis_addlayers.png"><img alt="Connect to Natural Earth" class="align-center" src="../../_images/postgis_addlayers.png" style="width: 450.0px; height: 378.0px;" /></a>
<p>Az adatbázisban lévő téradat táblák listáját kapja meg:</p>
<a class="reference internal image-reference" href="../../_images/postgis_listtables.png"><img alt="Natural Earth Layers" class="align-center" src="../../_images/postgis_listtables.png" style="width: 450.0px; height: 378.0px;" /></a>
<p>Válassza az ne_10m_lake táblát és kattintson az <code class="docutils literal"><span class="pre">Add</span></code> (Hozzáad) gombra alul (ne a <code class="docutils literal"><span class="pre">Load</span></code>-ra (Betölt) felül - az az adatbázis paramétereket tölti be) és ezzel betöltjük a QGIS-be:</p>
<a class="reference internal image-reference" href="../../_images/postgis_lakesmap.png"><img alt="My First PostGIS layer" class="align-center" src="../../_images/postgis_lakesmap.png" style="width: 1146.0px; height: 952.5px;" /></a>
<p>A tavak térképét kellene látnia a QGIS-ben. A QGIS nem tudja, hogy ezek tavak, így lehet hogy nem kékre színezi azokat - deritse ki a QGIS dokumentációból, hogyan változtathatja meg a színt. Nagyítson rá a kanadai tavak egy híres csoportjára.</p>
</div>
<div class="section" id="importing-spatial-data-into-the-database">
<h2><a class="toc-backref" href="#id7">Téradatok importálása az adatbázisba</a><a class="headerlink" href="#importing-spatial-data-into-the-database" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>A legtöbb OSGeo asztali eszközben van más formátumú téradatok fájlból (például ESRI shape)  importálás funkciója az adatbázisba. Ismét a QGIS használjuk ennek bemutatására.</p>
<p>A QGIS-ben a shape fájlok importálását a praktikus QGIS Database Manager (QGIS adatbázis-kezelő) segítségével tehetjük meg. A menüben találja meg a kezelőt. Menjen a menüben ide <code class="docutils literal"><span class="pre">Database</span> <span class="pre">-&gt;</span> <span class="pre">DB</span> <span class="pre">Manager</span> <span class="pre">-&gt;</span> <span class="pre">DB</span> <span class="pre">Manager</span></code> (Adatbázis-&gt;DB kezelő-&gt;DB kezelő).</p>
<p>Bontsa szét a PostGIS elemet, majd a NaturalEarth elemet. Ezután kapcsolódik a Natural Earth adatbázishoz. Hagyja üresen a jelszót, ha kérdezik. A public elemben az adatbázis által szolgáltatott rétegek listája van. A fő kezelő ablakot látja. A bal oldalon az adatbázisból választhat egy táblát és használja a füleket a jobb oldalon, hogy megtudjon valamit róluk. A Preview (Előnézet) fül egy kis térképet mutat.</p>
<a class="reference internal image-reference" href="../../_images/postgis_managerpreview.png"><img alt="QGIS Manager Preview" class="align-center" src="../../_images/postgis_managerpreview.png" style="width: 610.5px; height: 428.25px;" /></a>
<p>Most a DB manager-t használjuk egy shape fájl adatbázisba importálásához. Az észak karolinai hirtelen csecsemőhalál-szindróma adatokat fogjuk használni, melyeket az egyik R statisztikai csomag bővítmény tartalmaz.</p>
<p>A <code class="docutils literal"><span class="pre">Table</span></code> menüből válassza az <code class="docutils literal"><span class="pre">Import</span> <span class="pre">layer/file</span></code> opciót. Kattintson a  <code class="docutils literal"><span class="pre">...</span></code> gombra és tallózzon a <code class="docutils literal"><span class="pre">sids.shp</span></code> shape fájlhoz az R <code class="docutils literal"><span class="pre">maptools</span></code> csomagban (a /usr/local/lib/R/site-library/spData/shapes mappában):</p>
<a class="reference internal image-reference" href="../../_images/postgis_browsedata.png"><img alt="Find the shapefile" class="align-center" src="../../_images/postgis_browsedata.png" style="width: 632.25px; height: 492.0px;" /></a>
<p>Hagyjon minden mást változatlanul és kattintson a <code class="docutils literal"><span class="pre">Load</span></code>-ra</p>
<a class="reference internal image-reference" href="../../_images/postgis_importsids.png"><img alt="Import a shapefile" class="align-center" src="../../_images/postgis_importsids.png" style="width: 346.5px; height: 400.5px;" /></a>
<p>Hagyja a vetületi rendszer kiválasztását az alapértelmezetten (WGS 84 EPSG:4326) és kattintson az <code class="docutils literal"><span class="pre">OK</span></code>-ra. A shape fájlt hiba nélkül kellene importálnia a rendszernek. Zárja be a PostGIS kezelőt és térjen vissza a QGIS fő ablakhoz.</p>
<p>Most töltse be az SIDS adatokat a térképre az «Add PostGIS Layer» opcióval. A rétegek egy kis átrendezésével és némi színezéssel képes lehet a következő kartogram létrehozására a hirtelen csecsemőhalál-szindróma számokból (sid74 vagy sid79 mező) Észak-Carolina-ban:</p>
<a class="reference internal image-reference" href="../../_images/postgis_sidsmap.png"><img alt="SIDS data mapped" class="align-center" src="../../_images/postgis_sidsmap.png" style="width: 1143.75px; height: 948.0px;" /></a>
</div>
<div class="section" id="get-to-know-pgadmin-iii">
<h2><a class="toc-backref" href="#id8">Ismerjük meg a pgAdmin III-t</a><a class="headerlink" href="#get-to-know-pgadmin-iii" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Használhatja a <code class="docutils literal"><span class="pre">pgAdmin</span> <span class="pre">III</span></code> grafikus adatbázist klienst a Databeses menüből a nem térbeli adatok lekérdezéséhez és módosításához. Ez a hivatalos kliens a PostgreSQL-hez.</p>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">Vegye figyelembe, hogy a pgAdmin-nak van új verziója a pgAdmin4, melyet az apt install pgadmin4 paranccsal telepíthet</p>
</div>
<p>A pgAdmin III lehetővé teszi az adattábláinak kezelését az SQL használatával. A Databases mappában találja és indíthatja a pgAdmin III-at.</p>
<a class="reference internal image-reference" href="../../_images/postgis_pgadmin_main_window.png"><img alt="pgAdmin III" class="align-center" src="../../_images/postgis_pgadmin_main_window.png" style="width: 511.0px; height: 370.5px;" /></a>
<p>Itt lehetősége van új kapcsolat létrehozására egy PostgreSQL szerverhez vagy kapcsolódhat egy már ismert szerverhez. Esetünkben az előre definiált <code class="docutils literal"><span class="pre">local</span></code> szerverhez fogunk kapcsolódni.</p>
<p>A kapcsolat létrejötte után láthatja a rendszerben már meglévő adatbázisok listáját.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen0.png"><img alt="pgAdmin III" class="align-center" src="../../_images/postgis_adminscreen0.png" style="width: 768.75px; height: 556.5px;" /></a>
<p>A piros „X” a legtöbb adatbázis előtti képen azt jelenti, hogy még nem kapcsolódott egyikhez sem (csak az alapértelmezett <code class="docutils literal"><span class="pre">postgres</span></code> adatbázishoz kapcsolódik). Ezen a ponton csak a létező adatbázisokat látja a rendszerben. Az adatbázis nevére duplán kattintva kapcsolódhat ahhoz. Tegye ezt a natural_earth2 adatbázisra.</p>
<p>Most azt láthatja, hogy a piros X eltűnt és egy „+” jelent meg balra. Ezt megnyomva egy fa jelenik meg mely az adatbázis tartalmát mutatja.</p>
<p>Navigáljon a <code class="docutils literal"><span class="pre">schemas</span></code> részfára és nyissa szét. Ezután nyissa szét a <code class="docutils literal"><span class="pre">public</span></code> sémát. A <code class="docutils literal"><span class="pre">Tables</span></code>-re navgálva és szétnyitva láthatja az összes táblát ebben a sémában.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen1.png"><img alt="pgAdmin III" class="align-center" src="../../_images/postgis_adminscreen1.png" style="width: 768.0px; height: 557.25px;" /></a>
</div>
<div class="section" id="executing-a-sql-query-from-pgadmin-iii">
<h2><a class="toc-backref" href="#id9">Egy SQL lekérdezés végrehajtása a pgAdmin III-ból</a><a class="headerlink" href="#executing-a-sql-query-from-pgadmin-iii" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>A pgAdmin biztosítja lekérdezések végrehajtásának lehetőségét a relációs adatbázisból.</p>
<p>Az adatbázison történő lekérdezés végrehajtásához nyomja meg az <code class="docutils literal"><span class="pre">SQL</span></code> gombot a fő eszközsorból (a sárga nagyítólencsét tartalmazóból).</p>
<p>Az SIDS arányát keressük a születésekhez minden városban 1974-ben. Továbbá rendezzük az eredményt a számított arányok alapján. Ehhez a következő lekérdezést kell végrehajtanunk (küldje el ezt az SQL ablak szövegszerkesztőjéből):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">sid74</span><span class="o">/</span><span class="n">bir74</span> <span class="k">as</span> <span class="n">rate</span> <span class="kn">from</span> <span class="nn">sids</span> <span class="n">order</span> <span class="n">by</span> <span class="n">rate</span><span class="p">;</span>
</pre></div>
</div>
<p>Ezután meg kell nyomnia a jobbra mutató zöld nyíl gombot (lekérdezés végrehajtása).</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen2.png"><img alt="pgAdmin III" class="align-center" src="../../_images/postgis_adminscreen2.png" style="width: 768.0px; height: 557.25px;" /></a>
</div>
<div class="section" id="get-to-know-foreign-data-wrappers-fdw">
<h2><a class="toc-backref" href="#id10">Get to know Foreign Data Wrappers (FDW)</a><a class="headerlink" href="#get-to-know-foreign-data-wrappers-fdw" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>From you database you can access remote objects like tables from other PostgreSQL databases or connect to remote databases like Oracle, MySQL, MS SQL or CouchDB.
You also can connect via ODBC, connect to CSV, Geospatial Data and even to twitter.</p>
<p>You find a list of different FDW at:</p>
<blockquote>
<div><a class="reference external" href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers">https://wiki.postgresql.org/wiki/Foreign_data_wrappers</a></div></blockquote>
<p>Let’s see how it works! The easiest way is to connect to a different PostgreSQL database.</p>
<p>Here are the steps:</p>
<p>First load the extension for the Foreign Data Wrapper that you want to use. For a connection to a different PostgreSQL database you need <code class="docutils literal"><span class="pre">postgres_fdw</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">postgres_fdw</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Javaslat</p>
<p class="last">Please note that in pgAdmin III the foreign data wrappers, foreign servers, user mappings and foreign tables are not displayed by default in the tree.
You have to activate them via menu via <span class="menuselection">File ‣ Options ‣ Browser ‣ Display</span></p>
</div>
<p>Create a foreign Server that tells you where to find the data source that you want to connect</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
 <span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">postgres_fdw</span>
 <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">host</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span> <span class="s1">&#39;5432&#39;</span><span class="p">,</span> <span class="n">dbname</span> <span class="s1">&#39;osm_local&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Define the user that should be used when you connect to the foreign server</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">USER</span> <span class="n">MAPPING</span> <span class="n">FOR</span> <span class="n">user</span>
      <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
      <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">user</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">password</span> <span class="s1">&#39;user&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now you can create a foreign table.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">public</span>
  <span class="n">LIMIT</span> <span class="n">TO</span> <span class="p">(</span><span class="n">planet_osm_polygon</span><span class="p">,</span> <span class="n">planet_osm_point</span><span class="p">)</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">EXCEPT</span>
  <span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
  <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p>Find new tables in your database and have a look at the data from a foreign table.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">planet_osm_polygon</span> <span class="n">limit</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="connect-to-a-remote-ogr-data-source-via-ogr-fdw">
<h2><a class="toc-backref" href="#id11">Connect to a remote OGR data source via ogr_fdw</a><a class="headerlink" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>The extension <code class="docutils literal"><span class="pre">ogr_fdw</span></code> allows connection too several geodata formats like KML,
GeoPackage, WFS, GeoJSON, GPX, GML and more.</p>
<p>Read more about <code class="docutils literal"><span class="pre">ogr_fdw</span></code>:
* Repository: <a class="reference external" href="https://github.com/pramsey/pgsql-ogr-fdw">https://github.com/pramsey/pgsql-ogr-fdw</a>
* New and improved: <a class="reference external" href="http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html">http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html</a></p>
<p class="rubric">Install the extension <code class="docutils literal"><span class="pre">ogr_fdw</span></code> in your database.</p>
<p>On the database prompt type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">ogr_fdw</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Inspect which formats are supported:</p>
<p>Open a terminal and search for ogr_fdw_info:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">locate</span> <span class="n">ogr_fdw_info</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ogr_fdw_info</span> <span class="o">-</span><span class="n">f</span>
</pre></div>
</div>
<p>Results might look like these:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Supported</span> <span class="n">Formats</span><span class="p">:</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;OGR_GRASS&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PCIDSK&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;netCDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;JP2OpenJPEG&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MBTiles&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;EEDA&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;ESRI Shapefile&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MapInfo File&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">....</span> <span class="n">many</span> <span class="n">more</span>
</pre></div>
</div>
<p class="rubric">Create a FDW to a WFS</p>
<p>Start Geoserver via <span class="menuselection">Geospatial ‣ Web Services ‣ GeoServer ‣  Start GeoServer</span></p>
<ul class="simple">
<li>Open GeoServer <a class="reference external" href="http://localhost:8082/geoserver/web/">http://localhost:8082/geoserver/web/</a></li>
<li>GeoServer WFS GetCapabilities <a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities</a></li>
<li>GeoServer WFS DescribeFeatureType for topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states</a></li>
<li>GeoServer WFS GetFeature topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states</a></li>
</ul>
<p class="rubric">Create a foreign server that refers to the WFS that you want to connect</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
<span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">ogr_fdw</span>
<span class="n">OPTIONS</span> <span class="p">(</span> <span class="n">datasource</span> <span class="s1">&#39;WFS:http://localhost:8082/geoserver/ows&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="s1">&#39;WFS&#39;</span> <span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Import all WFS feature_types as foreign tables with one command.</p>
<p>After the import you will see several new foreign tables in your schema.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">ogr_all</span>
<span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
   <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Inspect the foreign data table <code class="docutils literal"><span class="pre">topp_states</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">topp_states</span> <span class="n">WHERE</span> <span class="n">state_name</span> <span class="o">=</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="things-to-try">
<h2><a class="toc-backref" href="#id12">Kipróbálandó dolgok</a><a class="headerlink" href="#things-to-try" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Íme néhány további kipróbálandó kihívás önnek:</p>
<ul class="simple">
<li>Próbáljon ki néhány további térbeli függvényt, mint <code class="docutils literal"><span class="pre">st_buffer(geom)</span></code>, <code class="docutils literal"><span class="pre">st_transform(geom,25831)</span></code>, <code class="docutils literal"><span class="pre">st_x(geom)</span></code> - a teljes dokumentációt a <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a> oldalon találja meg.</li>
<li>Exportálja a tábláit shape fájlba a parancssorból a <code class="docutils literal"><span class="pre">pgsql2shp</span></code>-val</li>
<li>Próbálja ki az adatok importálását/exportálását az adatbázisába a parancssorból a <code class="docutils literal"><span class="pre">ogr2ogr</span></code>-el.</li>
<li>Próbálja ki az adatok importálását az adatbázisba a parancssorból a <code class="docutils literal"><span class="pre">shp2pgsql</span></code>-el.</li>
<li>Próbálja ki az útvonal tervezést a <a class="reference internal" href="../overview/pgrouting_overview.html"><span class="doc">pgRouting</span></a> segítségével.</li>
</ul>
</div>
<div class="section" id="what-next">
<h2><a class="toc-backref" href="#id13">Mi a következő?</a><a class="headerlink" href="#what-next" title="Hivatkozás erre a fejezetcímre">¶</a></h2>
<p>Ez csak az első lépés az úton a PostGIS használatához. Sokkal szélesebb a funkcionalitása amit kipróbálhat.</p>
<ul class="simple">
<li>PostGIS Projekt honlap - <a class="reference external" href="http://postgis.net">http://postgis.net</a></li>
<li>PostGIS Dokumentáció -  <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></li>
</ul>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a>
		</div>
	</font>
    </div>



        
        
<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>
        


  </body>
</html>

<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>pygeoapiクイックスタート &#8212; OSGeoLive 17.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/overview.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/../_themes/overview/static/overview.css" />
    <script data-url_root="../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="next" title="Zoo プロジェクト" href="../overview/zoo-project_overview.html" />
    <link rel="prev" title="pygeoapi" href="../overview/pygeoapi_overview.html" />
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>


  </head><body>

        
        
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/osgeolive-banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
    </div>
        


    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('sv')">Svenska</a>
		</div>
	</font>
    </div>

  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="https://pygeoapi.io/"><img alt="../../_images/logo_pygeoapi.png" class="align-right" src="../../_images/logo_pygeoapi.png" /></a>
<a class="reference external image-reference" href="https://www.osgeo.org"><img alt="../../_images/OSGeo_project.png" class="align-right" src="../../_images/OSGeo_project.png" /></a>
<section id="pygeoapi-quickstart">
<h1>pygeoapiクイックスタート<a class="headerlink" href="#pygeoapi-quickstart" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>pygeoapiは、OGC Open APIサービスをWeb上で迅速かつ容易に公開するためのツールです。(geo)pythonコミュニティの強力なオープンソースライブラリ上に構築されています。</p>
<p>このクイックスタートでは、ソフトウェアのセットアップ方法を説明し、特定ケースを想定して使用してみます。pygeoapiはビジネス、ビジネスケースを満たすために他のコンポーネントと組み合わされる製品なので、説明の途中で関連するソフトウェアをいくつか取り上げます。</p>
<section id="prior-knowledge">
<h2>前提知識<a class="headerlink" href="#prior-knowledge" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>pygeoapiは空間ドメイン用のPython Webアプリケーションであるため、Webアプリケーションの概念と、グリッドおよびベクタフォーマット、OGC標準、投影システムなどの空間処理的側面を意識する必要があります。Pythonの知識が推奨されますが、OSGeoLiveからアプリケーションを実行しなくてもかまいません。</p>
<div class="contents local topic" id="contents">
<p class="topic-title">目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#configure-and-start-the-service" id="id1">設定とサービスの開始</a></p></li>
<li><p><a class="reference internal" href="#configure-new-service" id="id2">新しいサービスの構成</a></p></li>
<li><p><a class="reference internal" href="#using-a-web-browser-to-query-the-api" id="id3">Webブラウザを使用したAPIのクエリー</a></p></li>
<li><p><a class="reference internal" href="#using-ogc-api-features-in-desktop-gis" id="id4">Using OGC API - Features in Desktop GIS</a></p></li>
</ul>
</div>
<section id="configure-and-start-the-service">
<h3><a class="toc-backref" href="#id1">設定とサービスの開始</a><a class="headerlink" href="#configure-and-start-the-service" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ol class="arabic">
<li><p>スタートメニューから <span class="menuselection">Structure ‣ osgeolive ‣ appmenupath ‣ pygeoapi</span> を選択します。Webページ <a class="reference external" href="http://localhost:5000">http://localhost:5000</a> でアプリケーションを開きます。</p></li>
<li><p>ユーザフォルダの <code class="docutils literal notranslate"><span class="pre">/usr/local/share/pygeoapi</span></code> へ行きファイル <code class="docutils literal notranslate"><span class="pre">pygeoapi-config.yml</span></code> を配置します。このファイルには、サービスの構成が含まれています。</p></li>
<li><p>コマンド <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">nano</span> <span class="pre">pygeoapi-config.yml</span></code> でファイルを開きます。</p></li>
<li><p>Title や Author など、ファイル内の一部のパラメータを更新します。ファイルを保存します。</p></li>
<li><p>端末を閉じてサービスを起動し直すなどして、サービスを再開します。</p>
<a class="reference internal image-reference" href="../../_images/pygeoapi_screenshot.png"><img alt="../../_images/pygeoapi_screenshot.png" src="../../_images/pygeoapi_screenshot.png" style="width: 280.0px; height: 138.6px;" /></a>
</li>
</ol>
</section>
<section id="configure-new-service">
<h3><a class="toc-backref" href="#id2">新しいサービスの構成</a><a class="headerlink" href="#configure-new-service" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここでは、ベクタ・データセットをpygeoapiにデプロイし、その機能をOGC API-Featuresとして公開します。OGC API - Fearures は、ベクタ機能をWebサービスとして公開するためのOGCの標準です。OGC API - Featuresは、WFSの代替となる OpenAPI機能です。</p>
<p>pygeoapiは、geopackage、PostGIS、Elasticsearch、WFSなど、ベクタソースとして使用する幅広いバックエンドをサポートしています。GDAL OGR プロバイダを経由して、ほぼ無制限に、他のベクタソース一式が追加できます。</p>
<p>Interesting datasets to expose as OGC API - Features consist of real world data having multiple attributes and links to other resources.
OSGeoLive contains a number of datasets we can use. An example is <code class="docutils literal notranslate"><span class="pre">/var/www/html/openlayers/examples/data/geojson/countries.geojson</span></code>.
You can configure it in pygeoapi using the GeoJSON provider.</p>
<ol class="arabic simple">
<li><p>GeoJSONファイルをダウンロードし、tests/data フォルダーに配置します。</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">pygeoapi-config.yml</span></code> to add <code class="docutils literal notranslate"><span class="pre">countries</span></code> as a new collection to pygeoapi (insert snippet below between the other collections. Mind the nesting, nesting is important in YAML syntax).</p></li>
</ol>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">countries</span><span class="p">:</span>
<span class="w">   </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="w">   </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Countries</span>
<span class="w">   </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Countries of the world</span>
<span class="w">   </span><span class="nt">keywords</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">industry</span>
<span class="w">   </span><span class="nt">links</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text/html</span>
<span class="w">        </span><span class="nt">rel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">canonical</span>
<span class="w">        </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">information</span>
<span class="w">        </span><span class="nt">href</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://openlayers.org</span>
<span class="w">        </span><span class="nt">hreflang</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en-US</span>
<span class="w">   </span><span class="nt">extents</span><span class="p">:</span>
<span class="w">      </span><span class="nt">spatial</span><span class="p">:</span>
<span class="w">         </span><span class="nt">bbox</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-180</span><span class="p p-Indicator">,</span><span class="nv">-90</span><span class="p p-Indicator">,</span><span class="nv">180</span><span class="p p-Indicator">,</span><span class="nv">90</span><span class="p p-Indicator">]</span>
<span class="w">   </span><span class="nt">providers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">feature</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GeoJSON</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/www/html/openlayers/examples/data/geojson/countries.geojson</span>
<span class="w">        </span><span class="nt">id_field</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>pygeoapiの再起動</p></li>
</ol>
<p>ブラウザで <a class="reference external" href="http://localhost:5000/collections/countries">http://localhost:5000/collections/countries</a> を開いて、コレクションの検証をおこなう</p>
</section>
<section id="using-a-web-browser-to-query-the-api">
<h3><a class="toc-backref" href="#id3">Webブラウザを使用したAPIのクエリー</a><a class="headerlink" href="#using-a-web-browser-to-query-the-api" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Now that we have the service available we can query it using various client tooling.
Each of the features of the collection is available in common formats, such as HTML, GeoJSON and GML. To start we can use a web browser to browse through the service. From <a class="reference external" href="http://localhost:5000/collections/countries">http://localhost:5000/collections/countries</a>, drill down to individual features. The service will automatically detect (accept header) that you are using a web browser and will return the HTML representation of features. Notice in the top right corner explicit links to override the accept header and request specific representations of the feature (<code class="docutils literal notranslate"><span class="pre">?f=json</span></code>).</p>
<p>各Open APIには、<a class="reference external" href="http://localhost:5000/openapi">http://localhost:5000/openapi</a> にインタラクティブなドキュメントページがあります。このインタラクティブなWebページでは、サービス内のさまざまなメソッドについて読むことができますが、Webフォームを介してそれらのメソッドと直接対話することもできます。</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/openapidoc.png"><img alt="../../_images/openapidoc.png" src="../../_images/openapidoc.png" style="width: 1009.4px; height: 368.2px;" /></a>
</div></blockquote>
<p>OGC API’s have been developed with the <a class="reference external" href="https://www.w3.org/TR/sdw-bp">W3C Spatial Data on the Web Best Practices</a> in mind. An important aspect of these best practices is search engine optimization. Pygeoapi adds some crawl optimizations on top of the requirements of the Open API standards; collection metadata can be crawled by search engines in a structured way, with the goal to make the collections discoverable in tools like Google Dataset Search. To evaluate the structured data capabilities you can use the Structured Data Testing tools of Yandex or Google. Copy the html source of the countries collection page (or the url of a collection page of an online pygeoapi instance) into a structured data testing tool and evaluate what structured data the tool is able to extract from it. The search engine will use that information in its datasets index.</p>
</section>
<section id="using-ogc-api-features-in-desktop-gis">
<h3><a class="toc-backref" href="#id4">Using OGC API - Features in Desktop GIS</a><a class="headerlink" href="#using-ogc-api-features-in-desktop-gis" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>このクイックスタートでは、QGISを用いてサービスのクエリを行ないますが、例えば ArcGIS, FME, OpenLayers といった他のツールでも、類似のワークフローを実施できます。</p>
<p>Starting from QGIS 3.14 you can add an OGC API - Features layer as vector layer. From the <code class="docutils literal notranslate"><span class="pre">Layer</span> <span class="pre">/</span> <span class="pre">Add</span> <span class="pre">Layer</span></code> menu select <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">WFS</span> <span class="pre">Layer...</span></code>.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/qgis-wfs.png"><img alt="../../_images/qgis-wfs.png" src="../../_images/qgis-wfs.png" style="width: 277.9px; height: 243.6px;" /></a>
</div></blockquote>
<p>新しい接続を作成するウィンドウが開いたら、サービスのURL <a class="reference external" href="http://localhost:5000">http://localhost:5000</a> を入力します。</p>
<p>OKをクリックして、サービスで使えるコレクションをロードするため <code class="docutils literal notranslate"><span class="pre">connect</span></code> します。</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../_images/qgis-layers.png"><img alt="../../_images/qgis-layers.png" src="../../_images/qgis-layers.png" style="width: 280.0px; height: 139.29999999999998px;" /></a>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">countries</span></code> コレクションを選択して、 ‘Add’ をクリックしてQGISマップにレイヤを追加します。</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('sv')">Svenska</a>
		</div>
	</font>
    </div>



        
        
<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>
        


  </body>
</html>

<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Guida rapida PostGIS &#8212; OSGeoLive 15.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/overview.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/../_themes/overview/static/overview.css" />
    <script data-url_root="../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Indice" href="../genindex.html" />
    <link rel="search" title="Cerca" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="pgRouting" href="../overview/pgrouting_overview.html" />
    <link rel="prev" title="PostGIS" href="../overview/postgis_overview.html" />
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>


  </head><body>

        
        
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/osgeolive-banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
    </div>
        


    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>

  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="http://postgis.net"><img alt="../../_images/logo_postgis.png" class="align-right" src="../../_images/logo_postgis.png" /></a>
<a class="reference external image-reference" href="https://www.osgeo.org"><img alt="../../_images/OSGeo_project.png" class="align-right" src="../../_images/OSGeo_project.png" /></a>
<section id="postgis-quickstart">
<h1>Guida rapida PostGIS<a class="headerlink" href="#postgis-quickstart" title="Link a questa intestazione">¶</a></h1>
<p>PostGIS aggiunge capabilities spaziali al database relazionale PostgreSQL. Estende PostgreSQL in modo che possa immagazzinare, interrogare e manipolare dati spaziali. In questo Quickstart useremo “PostgreSQL” quando descriveremo le funzioni generali del database, e “PostGIS” quando descriveremo le funzionalità spaziali aggiuntive fornite da PostGIS.</p>
<p>Questa Guida Rapida descrive come:</p>
<blockquote>
<div><ul class="simple">
<li><p>Crea e interroga un database spaziale da linea di comando e <a class="reference internal" href="../overview/qgis_overview.html"><span class="doc">QGIS</span></a> interfaccia grafica.</p></li>
<li><p>Gestire i dati dal client <code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code></p></li>
</ul>
</div></blockquote>
<div class="contents local topic" id="contents">
<p class="topic-title">Contenuti</p>
<ul class="simple">
<li><p><a class="reference internal" href="#client-server-architecture" id="id1">Architettura client-server</a></p></li>
<li><p><a class="reference internal" href="#creating-a-spatially-enabled-database" id="id2">Creare un database spaziale</a></p></li>
<li><p><a class="reference internal" href="#creating-a-spatial-table-using-sql" id="id3">Creare una tabella spaziale usando SQL</a></p></li>
<li><p><a class="reference internal" href="#simple-queries" id="id4">Interrogazioni semplici</a></p></li>
<li><p><a class="reference internal" href="#spatial-queries" id="id5">Interrogazioni spaziali</a></p></li>
<li><p><a class="reference internal" href="#mapping" id="id6">Mappatura</a></p></li>
<li><p><a class="reference internal" href="#importing-spatial-data-into-the-database" id="id7">Importare dati spaziali nel database</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-phppgadmin-iso-vmdk" id="id8">Conoscere phpPgAdmin (ISO e VMDK)</a></p></li>
<li><p><a class="reference internal" href="#executing-a-sql-query-from-phppgadmin-iso-vmdk" id="id9">Esecuzione di una interrogazione SQL da phpPgAdmin (ISO e VMDK)</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-pgadmin-vmdk-only" id="id10">Conoscere pgAdmin (solo VMDK)</a></p></li>
<li><p><a class="reference internal" href="#executing-a-sql-query-from-pgadmin-vmdk-only" id="id11">Esecuzione di una interrogazione SQL da pgAdmin (solo VMDK)</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-foreign-data-wrappers-fdw" id="id12">Conoscere i Foreign Data Wrappers (FDW)</a></p></li>
<li><p><a class="reference internal" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" id="id13">Connettersi a un’origine dati OGR remota tramite ogr_fdw</a></p></li>
<li><p><a class="reference internal" href="#things-to-try" id="id14">Cose da provare</a></p></li>
<li><p><a class="reference internal" href="#what-next" id="id15">E ora?</a></p></li>
</ul>
</div>
<section id="client-server-architecture">
<h2><a class="toc-backref" href="#id1">Architettura client-server</a><a class="headerlink" href="#client-server-architecture" title="Link a questa intestazione">¶</a></h2>
<p>PostgreSQL, come molti database, funziona come un server in un sistema client-server. Il client fa una richiesta al server e riceve una risposta. Questo è lo stesso modo in cui funziona internet - il tuo browser è un cliente e un server web rimanda indietro la pagina web. Con PostgreSQL le richieste sono in linguaggio SQL e la risposta è di solito una tabella di dati dal database.</p>
<p>Non c’è nulla che impedisca al server di essere sullo stesso computer del client, e questo ti permette di usare PostgreSQL su una sola macchina. Il tuo client si connette al server tramite la connessione di rete interna “loopback”, e non è visibile agli altri computer a meno che tu non lo configuri.</p>
</section>
<section id="creating-a-spatially-enabled-database">
<h2><a class="toc-backref" href="#id2">Creare un database spaziale</a><a class="headerlink" href="#creating-a-spatially-enabled-database" title="Link a questa intestazione">¶</a></h2>
<p>I client a riga di comando vengono eseguiti da una finestra dell’Emulatore di Terminale.</p>
<p>Avvia un Emulatore di Terminale (attualmente LXTerminal) dal menu Applicazioni nella sezione Accessori. In questo modo si ottiene un prompt di comandi della shell Unix. Digita:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">V</span>
</pre></div>
</div>
<p>e premi invio per vedere il numero di versione di PostgreSQL.</p>
<p>Un singolo server PostgreSQL permette di organizzare il lavoro organizzandolo in database separati. Ogni database è un regime indipendente, con le proprie tabelle, viste, utenti e così via. Quando ti connetti a un server PostgreSQL devi specificare un database.</p>
<p>Puoi ottenere una lista di database sul server con il comando:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
<p>comando. Dovresti vedere diversi database usati da alcuni progetti nel sistema. Ne crei uno nuovo per questo quickstart.</p>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>La lista usa un pager standard di Unix - premi spazio per la pagina successiva, <kbd class="kbd docutils literal notranslate">b</kbd> per tornare indietro, <kbd class="kbd docutils literal notranslate">q</kbd> per uscire, h per aiuto.</p>
</div>
<p>PostgreSQL ti dà un programma di utilità per creare database, <code class="docutils literal notranslate"><span class="pre">createdb</span></code>. Hai bisogno di creare un database prima di aggiungere le estensioni PostGIS. Chiama il tuo database <code class="docutils literal notranslate"><span class="pre">demo</span></code>. Il comando è quindi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">createdb</span> <span class="n">demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>Di solito puoi ottenere aiuto per gli strumenti a riga di comando usando l’opzione <code class="docutils literal notranslate"><span class="pre">--help</span></code>.</p>
</div>
<p>Se ora esegui <code class="docutils literal notranslate"><span class="pre">psql</span> <span class="pre">-l</span></code> dovresti vedere il tuo database <code class="docutils literal notranslate"><span class="pre">demo</span></code> nella lista. Non hai ancora aggiunto l’estensione PostGIS, ma nella prossima sezione imparerai come.</p>
<p>Puoi creare database PostGIS usando il linguaggio SQL. Prima cancelleremo il database che abbiamo appena creato usando il comando <code class="docutils literal notranslate"><span class="pre">dropdb</span></code>, poi useremo il comando <code class="docutils literal notranslate"><span class="pre">psql</span></code> per ottenere un interprete di comandi SQL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dropdb</span> <span class="n">demo</span>
<span class="n">psql</span> <span class="o">-</span><span class="n">d</span> <span class="n">postgres</span>
</pre></div>
</div>
<p>Questo si connette al database di sistema principale chiamato <code class="docutils literal notranslate"><span class="pre">postgres</span></code>. Ora inserisci l’SQL per creare un nuovo database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># CREATE DATABASE demo;</span>
</pre></div>
</div>
<p>Ora passa la tua connessione dal database <code class="docutils literal notranslate"><span class="pre">postgres</span></code> al nuovo database <code class="docutils literal notranslate"><span class="pre">demo</span></code>. In futuro potrai connetterti direttamente con <code class="docutils literal notranslate"><span class="pre">psql</span> <span class="pre">-d</span> <span class="pre">demo</span></code>, ma qui c’è un modo pulito di passare dalla linea di comando <code class="docutils literal notranslate"><span class="pre">psql</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># \c demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>Premere <kbd class="kbd docutils literal notranslate">CTRL</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd> se il prompt di psql continua ad apparire dopo aver premuto return. Cancellerà il tuo input e ricomincerà. Probabilmente sta aspettando un virgolettato di chiusura, un punto e virgola, o qualcosa del genere.</p>
</div>
<p>Dovresti vedere un messaggio informativo e il prompt cambierà per mostrare che ora sei connesso al database <code class="docutils literal notranslate"><span class="pre">demo</span></code>.</p>
<p>Successivamente, aggiungi l’estensione PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># create extension postgis;</span>
</pre></div>
</div>
<p>Per verificare che tu abbia postgis installato, esegui la seguente query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT postgis_version();</span>

           <span class="n">postgis_version</span>
<span class="o">---------------------------------------</span>
 <span class="mf">2.3</span> <span class="n">USE_GEOS</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_PROJ</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_STATS</span><span class="o">=</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS installa molte funzioni, una tabella e diverse viste</p>
<p>Digita <code class="docutils literal notranslate"><span class="pre">\dt</span></code> per elencare le tabelle nel database. Dovresti vedere qualcosa di simile a questo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dt</span>
             <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>       <span class="o">|</span> <span class="n">Type</span>  <span class="o">|</span> <span class="n">Owner</span>
<span class="o">--------+------------------+-------+-------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">spatial_ref_sys</span>  <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">user</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>La tabella <code class="docutils literal notranslate"><span class="pre">spatial_ref_sys</span></code> è usata da PostGIS per la conversione tra diversi sistemi di riferimento spaziale. La tabella <code class="docutils literal notranslate"><span class="pre">spatial_ref_sys</span></code> memorizza informazioni sui sistemi di riferimento spaziali validi, e puoi usare un po” di SQL per dare un’occhiata veloce:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT srid, auth_name, proj4text FROM spatial_ref_sys LIMIT 10;</span>

 <span class="n">srid</span> <span class="o">|</span> <span class="n">auth_name</span> <span class="o">|</span>          <span class="n">proj4text</span>
<span class="o">------+-----------+--------------------------------------</span>
 <span class="mi">3819</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">towgs</span><span class="o">...</span>
 <span class="mi">3821</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">3824</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3889</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3906</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4001</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">airy</span> <span class="o">+</span><span class="n">no_defs</span><span class="o">...</span>
 <span class="mi">4002</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377340.189</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
 <span class="mi">4003</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">4004</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4005</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377492.018</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Questo conferma che hai un database spaziale.</p>
<p>Oltre a questa tabella, troverai diverse viste create quando abiliti postgis nel tuo database.</p>
<p>Digita <code class="docutils literal notranslate"><span class="pre">\dv</span></code> per elencare le viste nel database. Dovresti vedere qualcosa di simile a questo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dv</span>
                                                                <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>        <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span>  <span class="n">Owner</span>
<span class="o">--------+-------------------+------+----------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geography_columns</span> <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geometry_columns</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_columns</span>    <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_overviews</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
<span class="p">(</span><span class="mi">4</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS supporta diversi tipi di dati spaziali:</p>
<blockquote>
<div><p><cite>geometry</cite> - è un tipo di dati che memorizza i dati come vettori disegnati su una superficie piana</p>
<p><cite>geography</cite> - è un tipo di dati che memorizza i dati come vettori disegnati su una superficie sferoidale</p>
<dl class="simple">
<dt><cite>raster</cite> - è un tipo di dati che memorizza i dati come una matrice n-dimensionale dove ogni posizione (pixel) rappresenta</dt><dd><p>un’area di spazio, e ogni banda (dimensione) ha un valore per ogni spazio di pixel.</p>
</dd>
</dl>
</div></blockquote>
<p>Le viste <code class="docutils literal notranslate"><span class="pre">geometry_columns</span></code>, <code class="docutils literal notranslate"><span class="pre">geography_columns</span></code> e <code class="docutils literal notranslate"><span class="pre">raster_columns</span></code> hanno il compito di dire a PostGIS quali tabelle hanno colonne PostGIS geometry, geography e raster.</p>
<p>Le panoramiche sono tabelle a bassa risoluzione per i dati raster. La tabella <code class="docutils literal notranslate"><span class="pre">raster_overviews</span></code> elenca tali tabelle e la loro colonna raster e la tabella di cui ciascuna è una panoramica. Le tabelle di riepilogo raster sono usate da strumenti come QGIS per fornire versioni a bassa risoluzione dei dati raster per un caricamento più veloce.</p>
<p>Il tipo PostGIS geometry è il primo e ancora il più popolare tipo usato dagli utenti di PostGIS. Concentrerai la tua attenzione su questo tipo.</p>
</section>
<section id="creating-a-spatial-table-using-sql">
<h2><a class="toc-backref" href="#id3">Creare una tabella spaziale usando SQL</a><a class="headerlink" href="#creating-a-spatial-table-using-sql" title="Link a questa intestazione">¶</a></h2>
<p>Ora che hai un database spaziale, puoi creare alcune tabelle spaziali.</p>
<p>Per prima cosa crea una normale tabella di database per memorizzare alcuni dati della città. Questa tabella ha tre campi - uno per un ID numerico che identifica la città, uno per il nome della città e un altro per la colonna della geometria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># CREATE TABLE cities ( id int4 primary key, name varchar(50), geom geometry(POINT,4326) );</span>
</pre></div>
</div>
<p>Convenzionalmente questa colonna geometria si chiama <code class="docutils literal notranslate"><span class="pre">geom</span></code> (la vecchia convenzione PostGIS era <code class="docutils literal notranslate"><span class="pre">the_geom</span></code>). Questo dice a PostGIS che tipo di geometria ha ogni elemento (punti, linee, poligoni ecc.), quante dimensioni (in questo caso 2, se avesse 3 o 4 dimensioni useresti POINTZ, POINTM, o POINTZM), e il sistema di riferimento spaziale. Hai usato le coordinate EPSG:4326 per le tue città.</p>
<p>Ora se controlli la tabella delle città dovresti vedere la nuova colonna, ed essere informato che la tabella attualmente non contiene righe.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * from cities;</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span> <span class="o">|</span> <span class="n">geom</span>
<span class="o">----+------+----------</span>
<span class="p">(</span><span class="mi">0</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Per aggiungere righe alla tabella usa alcune istruzioni SQL. Per ottenere la geometria nella colonna geometria usa la funzione PostGIS <code class="docutils literal notranslate"><span class="pre">ST_GeomFromText</span></code> per convertire da un formato testo che fornisce le coordinate e un id del sistema di riferimento spaziale:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (1,ST_GeomFromText(&#39;POINT(-0.1257 51.508)&#39;,4326),&#39;London, England&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (2,ST_GeomFromText(&#39;POINT(-81.233 42.983)&#39;,4326),&#39;London, Ontario&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (3,ST_GeomFromText(&#39;POINT(27.91162491 -33.01529)&#39;,4326),&#39;East London,SA&#39;);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Suggerimento</p>
<p>Usare i tasti freccia per richiamare e modificare le linee di comando.</p>
</div>
<p>Come puoi vedere questo diventa sempre più noioso molto rapidamente. Fortunatamente ci sono altri modi per ottenere dati nelle tabelle PostGIS che sono molto più semplici. Ma ora hai tre città nel tuo database, e puoi lavorare con quello.</p>
</section>
<section id="simple-queries">
<h2><a class="toc-backref" href="#id4">Interrogazioni semplici</a><a class="headerlink" href="#simple-queries" title="Link a questa intestazione">¶</a></h2>
<p>Tutte le solite operazioni SQL possono essere applicate per selezionare i dati da una tabella PostGIS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span>                      <span class="n">geom</span>
<span class="o">----+-----------------+----------------------------------------------------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">BBB88D06F016C0BF1B2FDD2406C14940</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">F4FDD478E94E54C0E7FBA9F1D27D4540</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="mf">0101000020E610000040</span><span class="n">AB064060E93B4059FAD005F58140C0</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Questo ci dà una versione esadecimale codificata delle coordinate, non così utile per gli umani.</p>
<p>Se vuoi dare un’occhiata alla tua geometria in formato WKT, puoi usare le funzioni ST_AsText(geom) o ST_AsEwkt(geom). Puoi anche usare ST_X(geom), ST_Y(geom) per ottenere il valore numerico delle coordinate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT id, ST_AsText(geom), ST_AsEwkt(geom), ST_X(geom), ST_Y(geom) FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>          <span class="n">st_astext</span>           <span class="o">|</span>               <span class="n">st_asewkt</span>                <span class="o">|</span>    <span class="n">st_x</span>     <span class="o">|</span>   <span class="n">st_y</span>
<span class="o">----+------------------------------+----------------------------------------+-------------+-----------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">0.1257</span> <span class="o">|</span>    <span class="mf">51.508</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">81.233</span> <span class="o">|</span>    <span class="mf">42.983</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="mf">27.91162491</span> <span class="o">|</span> <span class="o">-</span><span class="mf">33.01529</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-queries">
<h2><a class="toc-backref" href="#id5">Interrogazioni spaziali</a><a class="headerlink" href="#spatial-queries" title="Link a questa intestazione">¶</a></h2>
<p>PostGIS aggiunge molte funzioni con funzionalità spaziali a PostgreSQL. Hai già visto ST_GeomFromText che converte WKT in geometria. La maggior parte di esse inizia con ST (per tipo spaziale) e sono elencate in una sezione della documentazione di PostGIS. Ora ne userai una per rispondere a una domanda pratica - quanto distano queste tre Londra l’una dall’altra, in metri, assumendo una terra sferica?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSphere(p1.geom,p2.geom) FROM cities AS p1, cities AS p2 WHERE p1.id &gt; p2.id;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancesphere</span>
<span class="o">-----------------+-----------------+--------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">5875766.85191657</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">9789646.96784908</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>   <span class="mf">13892160.9525778</span>
 <span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Questo ti dà la distanza, in metri, tra ogni coppia di città. Nota come la parte “WHERE” della linea ti impedisce di ottenere le distanze di una città da se stessa (che saranno tutte pari a zero) o le distanze inverse a quelle della tabella precedente (London, England to London, Ontario è la stessa distanza di London, Ontario to London, England). Prova senza la parte “WHERE” e vedi cosa succede.</p>
<p>Puoi anche calcolare la distanza usando uno sferoide usando una funzione diversa e specificando il nome dello sferoide, l’asse semi-maggiore e i parametri di appiattimento inverso:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSpheroid(</span>
        <span class="n">p1</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span><span class="n">p2</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="s1">&#39;SPHEROID[&quot;GRS_1980&quot;,6378137,298.257222]&#39;</span>
        <span class="p">)</span>
       <span class="n">FROM</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p1</span><span class="p">,</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p2</span> <span class="n">WHERE</span> <span class="n">p1</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="o">.</span><span class="n">id</span><span class="p">;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancespheroid</span>
<span class="o">-----------------+-----------------+----------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">5892413.63776489</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">9756842.65711931</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>     <span class="mf">13884149.4140698</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>Per uscire dalla riga di comando di PostgreSQL, inserire:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">q</span>
</pre></div>
</div>
<p>Ora sei tornato alla console di sistema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@osgeolive:~$
</pre></div>
</div>
</section>
<section id="mapping">
<h2><a class="toc-backref" href="#id6">Mappatura</a><a class="headerlink" href="#mapping" title="Link a questa intestazione">¶</a></h2>
<p>Per produrre una mappa dai dati PostGIS, hai bisogno di un client che possa arrivare ai dati. La maggior parte dei programmi GIS desktop open source possono farlo - QGIS, gvSIG, uDig per esempio. Ora ti mostrerò come fare una mappa da QGIS.</p>
<p>Avvia QGIS dal menu Desktop GIS e scegli <code class="docutils literal notranslate"><span class="pre">Aggiungi</span> <span class="pre">layer</span> <span class="pre">PostGIS</span></code> dal menu dei layer. I parametri per la connessione ai dati di Natural Earth in PostGIS sono già definiti nel menu a tendina Connessioni. Qui puoi definire nuove connessioni al server e memorizzare le impostazioni per richiamarle facilmente. Clicca sul menu a tendina Connessioni e scegli Natural Earth. Premi <code class="docutils literal notranslate"><span class="pre">Modifica</span></code> se vuoi vedere quali sono questi parametri per Natural Earth, o premi semplicemente <code class="docutils literal notranslate"><span class="pre">Connetti</span></code> per continuare:</p>
<a class="reference internal image-reference" href="../../_images/postgis_addlayers.png"><img alt="Connettere a Natural Earth" class="align-center" src="../../_images/postgis_addlayers.png" style="width: 705.75px; height: 254.25px;" /></a>
<p>Ora otterrai un elenco delle tabelle spaziali nel database:</p>
<a class="reference internal image-reference" href="../../_images/postgis_listtables.png"><img alt="Layer di Natural Earth" class="align-center" src="../../_images/postgis_listtables.png" style="width: 709.5px; height: 394.5px;" /></a>
<p>Scegliere la tabella ne_10m_lakes e premere <code class="docutils literal notranslate"><span class="pre">Add</span></code> in basso (non <code class="docutils literal notranslate"><span class="pre">Load</span></code> in alto - che carica i parametri di connessione al database), e dovrebbe essere caricata in QGIS:</p>
<a class="reference internal image-reference" href="../../_images/postgis_lakesmap.png"><img alt="Il Mio Primo layer PostGIS" class="align-center" src="../../_images/postgis_lakesmap.png" style="width: 1029.0px; height: 605.25px;" /></a>
<p>Ora dovresti vedere una mappa dei laghi. QGIS non sa che sono laghi, quindi potrebbe non colorarli di blu per te - usa la documentazione di QGIS per capire come cambiare questo. Ingrandisci un famoso gruppo di laghi in Canada.</p>
</section>
<section id="importing-spatial-data-into-the-database">
<h2><a class="toc-backref" href="#id7">Importare dati spaziali nel database</a><a class="headerlink" href="#importing-spatial-data-into-the-database" title="Link a questa intestazione">¶</a></h2>
<p>La maggior parte degli strumenti desktop OSGeo hanno funzioni per importare dati spaziali da altri formati (ad es. ESRI Shape) nel database. Ancora una volta userai QGIS per mostrare questo.</p>
<p>L’importazione di shapefiles in QGIS può essere fatta tramite il pratico QGIS Database Manager. Trovi il manager nel menu. Vai a <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">-&gt;</span> <span class="pre">DB</span> <span class="pre">Manager</span></code>.</p>
<p>Distribuisce l’oggetto Postgis, poi l’oggetto NaturalEarth. Si collegherà quindi al database di Natural Earth. Lascia la password in bianco se te lo chiede. Nella voce pubblica, c’è l’elenco dei layer forniti dal database. Vedrai la finestra principale del gestore. Sulla sinistra puoi selezionare le tabelle dal database e usare le schede sulla destra per scoprirle. La scheda Anteprima ti mostrerà una piccola mappa.</p>
<a class="reference internal image-reference" href="../../_images/postgis_managerpreview.png"><img alt="Anteprima di QGIS Manager" class="align-center" src="../../_images/postgis_managerpreview.png" style="width: 929.25px; height: 599.25px;" /></a>
<p>Ora userai il DB Manager per importare uno shapefile nel database. Userai i dati della sindrome della morte improvvisa del neonato (SIDS) della Carolina del Nord che sono inclusi in uno dei componenti aggiuntivi del pacchetto di statistiche R.</p>
<p>Dal menu <code class="docutils literal notranslate"><span class="pre">Tabella</span></code> scegli l’opzione <code class="docutils literal notranslate"><span class="pre">Importa</span> <span class="pre">layer/file</span></code>. Premi il pulsante <code class="docutils literal notranslate"><span class="pre">...</span></code> e cerca lo shapefile <code class="docutils literal notranslate"><span class="pre">sids.shp</span></code> nella directory di R. (situato in /home/user/data/vector/R/shapes):</p>
<a class="reference internal image-reference" href="../../_images/postgis_browsedata.png"><img alt="Trovare lo shapefile" class="align-center" src="../../_images/postgis_browsedata.png" style="width: 631.5px; height: 312.0px;" /></a>
<p>Lascia tutto il resto com’è e premi <code class="docutils literal notranslate"><span class="pre">Carica</span></code>.</p>
<a class="reference internal image-reference" href="../../_images/postgis_importsids.png"><img alt="Importare uno shapefile" class="align-center" src="../../_images/postgis_importsids.png" style="width: 346.5px; height: 400.5px;" /></a>
<p>Lascia che il selettore del sistema di riferimento delle coordinate sia predefinito su (WGS 84 EPSG:4326) e premi <code class="docutils literal notranslate"><span class="pre">OK</span></code>. Lo shapefile dovrebbe essere importato in PostGIS senza errori. Chiudi il DB Manager e torna alla finestra principale di QGIS.</p>
<p>Ora carica i dati della SIDS nella mappa usando l’opzione “Aggiungi Layer PostGIS”. Con un po” di riordino dei layer e qualche colorazione, dovresti essere in grado di produrre una mappa coropleta dei conteggi della sindrome della morte improvvisa del lattante (campi sid74 o sid79) in North Carolina:</p>
<a class="reference internal image-reference" href="../../_images/postgis_sidsmap.png"><img alt="Mappatura dei dati SIDS" class="align-center" src="../../_images/postgis_sidsmap.png" style="width: 1036.5px; height: 607.5px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Avvertimento</p>
<p>A seconda della versione di OSGeoLive utilizzata (ISO o VMDK), non saranno disponibili gli stessi client. <code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code> è il client ufficiale per PostgreSQL, tuttavia, per motivi tecnici, non può essere presente nella ISO, quindi è disponibile solo nella versione VMDK. La versione ISO ha il client <code class="docutils literal notranslate"><span class="pre">phpPgAdmin</span></code> che offre le stesse funzionalità di base.</p>
</div>
</section>
<section id="get-to-know-phppgadmin-iso-vmdk">
<h2><a class="toc-backref" href="#id8">Conoscere phpPgAdmin (ISO e VMDK)</a><a class="headerlink" href="#get-to-know-phppgadmin-iso-vmdk" title="Link a questa intestazione">¶</a></h2>
<p>In both versions, you can use the graphical database client phpPgAdmin.</p>
<p>phpPgAdmin consente di utilizzare SQL per manipolare le tabelle di dati. È possibile trovare e lanciare phpPgAdmin dalla cartella Databases, presente sul Desktop di OSGeoLive.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadmin_main_window.png"><img alt="phpPgAdmin main" class="align-center" src="../../_images/postgis_phppgadmin_main_window.png" style="width: 396.0px; height: 227.0px;" /></a>
<p>Qui si ha la possibilità di creare una nuova connessione a un server PostgreSQL o di connettersi a un server esistente. La «X» rossa sul server <code class="docutils literal notranslate"><span class="pre">PostgreSQL</span></code> indica che non si è ancora connessi. Fare clic su di essa e inserire il nome utente <code class="docutils literal notranslate"><span class="pre">user</span></code> e la master password <code class="docutils literal notranslate"><span class="pre">user</span></code>.</p>
<p>Dopo aver stabilito la connessione, puoi vedere l’elenco dei database già esistenti nel sistema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen0.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen0.png" style="width: 666.75px; height: 353.25px;" /></a>
<p>A questo punto è possibile vedere solo i database esistenti nel sistema. È possibile connettersi facendo clic sul segno più a sinistra del nome di un database. Fatelo per il database <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code>.</p>
<p>Ora si può vedere che c’è un solo schema in questo database, chiamato <code class="docutils literal notranslate"><span class="pre">public</span></code>. Facendo clic sul più a sinistra di <a href="#id1"><span class="problematic" id="id2">``</span></a>Tabelle”” per espanderlo, si possono vedere tutte le tabelle contenute in questo schema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen1.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen1.png" style="width: 848.25px; height: 538.5px;" /></a>
</section>
<section id="executing-a-sql-query-from-phppgadmin-iso-vmdk">
<h2><a class="toc-backref" href="#id9">Esecuzione di una interrogazione SQL da phpPgAdmin (ISO e VMDK)</a><a class="headerlink" href="#executing-a-sql-query-from-phppgadmin-iso-vmdk" title="Link a questa intestazione">¶</a></h2>
<p>phpPgAdmin offre la possibilità di eseguire interrogazioni in un database relazionale.</p>
<p>Per eseguire una interrogazione sul database, clicca nuovamente sul database <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code> e poi premi il pulsante <code class="docutils literal notranslate"><span class="pre">SQL</span></code> dalla barra degli strumenti principale (quello a sinistra con il simbolo del database).</p>
<p>Troverai il tasso di SIDS sulle nascite per il 1974 per ogni città. Inoltre ordinerai il risultato in base al tasso calcolato. Per fare ciò, devi eseguire la seguente query (presentarla nell’editor di testo della finestra SQL):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">sid74</span><span class="o">/</span><span class="n">bir74</span> <span class="k">as</span> <span class="n">rate</span> <span class="kn">from</span> <span class="nn">sids</span> <span class="n">order</span> <span class="n">by</span> <span class="n">rate</span><span class="p">;</span>
</pre></div>
</div>
<p>Successivamente, si deve premere il pulsante Execute.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen2.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen2.png" style="width: 634.5px; height: 536.25px;" /></a>
</section>
<section id="get-to-know-pgadmin-vmdk-only">
<h2><a class="toc-backref" href="#id10">Conoscere pgAdmin (solo VMDK)</a><a class="headerlink" href="#get-to-know-pgadmin-vmdk-only" title="Link a questa intestazione">¶</a></h2>
<p>Puoi usare il client grafico del database <code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code> dal menu Database per interrogare e modificare il tuo database in modo non spaziale. Questo è il client ufficiale per PostgreSQL.</p>
<p>pgAdmin ti permette di usare SQL per manipolare le tue tabelle di dati. Puoi trovare e lanciare pgAdmin dalla cartella Databases, esistente sul desktop di OSGeoLive.</p>
<a class="reference internal image-reference" href="../../_images/postgis_pgadmin_main_window.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_pgadmin_main_window.png" style="width: 574.5px; height: 319.5px;" /></a>
<p>Inserire la password principale <code class="docutils literal notranslate"><span class="pre">user</span></code>.</p>
<p>Qui hai la possibilità di creare una nuova connessione a un server PostgreSQL o di connetterti a un server esistente. In questo caso, ci connetteremo al server predefinito <code class="docutils literal notranslate"><span class="pre">localhost</span></code>.</p>
<p>Dopo aver stabilito la connessione, puoi vedere l’elenco dei database già esistenti nel sistema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen0.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen0.png" style="width: 871.5px; height: 639.0px;" /></a>
<p>La «X» rossa sull’immagine della maggior parte dei database, denota che non sei stato ancora connesso a nessuno di essi (sei connesso solo al database predefinito <code class="docutils literal notranslate"><span class="pre">postgres</span></code>). A questo punto sei in grado di vedere solo i database esistenti sul sistema. Puoi connetterti cliccando due volte sul nome di un database. Fallo per il database <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code>.</p>
<p>Ora puoi vedere che la X rossa è scomparsa e un «&gt;» è apparso sulla sinistra. Premendolo apparirà un albero che mostra il contenuto del database.</p>
<p>Naviga al sottoalbero <code class="docutils literal notranslate"><span class="pre">schemi</span></code>, espandilo. Poi espandi lo schema <code class="docutils literal notranslate"><span class="pre">public</span></code>. Navigando ed espandendo le <code class="docutils literal notranslate"><span class="pre">Tables</span></code>, puoi vedere tutte le tabelle contenute in questo schema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen1.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen1.png" style="width: 711.0px; height: 629.25px;" /></a>
</section>
<section id="executing-a-sql-query-from-pgadmin-vmdk-only">
<h2><a class="toc-backref" href="#id11">Esecuzione di una interrogazione SQL da pgAdmin (solo VMDK)</a><a class="headerlink" href="#executing-a-sql-query-from-pgadmin-vmdk-only" title="Link a questa intestazione">¶</a></h2>
<p>pgAdmin offre la possibilità di eseguire query a un database relazionale.</p>
<p>Per eseguire una query sul database, devi premere il pulsante <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">Tool</span></code> dalla barra degli strumenti principale (quella a sinistra con il simbolo del database).</p>
<p>Troverai il tasso di SIDS sulle nascite per il 1974 per ogni città. Inoltre ordinerai il risultato in base al tasso calcolato. Per fare ciò, devi eseguire la seguente query (presentarla nell’editor di testo della finestra SQL):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">sid74</span><span class="o">/</span><span class="n">bir74</span> <span class="k">as</span> <span class="n">rate</span> <span class="kn">from</span> <span class="nn">sids</span> <span class="n">order</span> <span class="n">by</span> <span class="n">rate</span><span class="p">;</span>
</pre></div>
</div>
<p>Successivamente, si dovrebbe premere il pulsante freccia che punta a destra (Eseguire).</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen2.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen2.png" style="width: 870.75px; height: 636.75px;" /></a>
</section>
<section id="get-to-know-foreign-data-wrappers-fdw">
<h2><a class="toc-backref" href="#id12">Conoscere i Foreign Data Wrappers (FDW)</a><a class="headerlink" href="#get-to-know-foreign-data-wrappers-fdw" title="Link a questa intestazione">¶</a></h2>
<p>Dal tuo database puoi accedere a oggetti remoti come tabelle da altri database PostgreSQL o connetterti a database remoti come Oracle, MySQL, MS SQL o CouchDB. È anche possibile connettersi via ODBC, connettersi a CSV, dati geospaziali e persino a Twitter.</p>
<p>Si trova una lista di diversi FDW all’indirizzo:</p>
<blockquote>
<div><p><a class="reference external" href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers">https://wiki.postgresql.org/wiki/Foreign_data_wrappers</a></p>
</div></blockquote>
<p>Vedi come funziona! Il modo più semplice è quello di connettersi a un altro database PostgreSQL.</p>
<p>Ecco i passaggi:</p>
<p>Prima carica l’estensione per il Foreign Data Wrapper che vuoi usare. Per una connessione a un altro database PostgreSQL hai bisogno di <code class="docutils literal notranslate"><span class="pre">postgres_fdw</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">postgres_fdw</span><span class="p">;</span>
</pre></div>
</div>
<p>Crea un Server «foreign» che dica dove trovare l’origine dati che si vuole connettere</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
 <span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">postgres_fdw</span>
 <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">host</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span> <span class="s1">&#39;5432&#39;</span><span class="p">,</span> <span class="n">dbname</span> <span class="s1">&#39;osm_local&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Definisci l’utente che dovrebbe essere usato quando ci si connette al server foreign</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">USER</span> <span class="n">MAPPING</span> <span class="n">FOR</span> <span class="n">user</span>
      <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
      <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">user</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">password</span> <span class="s1">&#39;user&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Ora puoi creare una tabella foreign.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">public</span>
  <span class="n">LIMIT</span> <span class="n">TO</span> <span class="p">(</span><span class="n">planet_osm_polygon</span><span class="p">,</span> <span class="n">planet_osm_point</span><span class="p">)</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">EXCEPT</span>
  <span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
  <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p>Trova nuove tabelle nel tuo database e dai un’occhiata ai dati di una tabella foreign.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">planet_osm_polygon</span> <span class="n">limit</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="connect-to-a-remote-ogr-data-source-via-ogr-fdw">
<h2><a class="toc-backref" href="#id13">Connettersi a un’origine dati OGR remota tramite ogr_fdw</a><a class="headerlink" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" title="Link a questa intestazione">¶</a></h2>
<p>L’estensione <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code> permette di collegare anche diversi formati di geodati come KML, GeoPackage, WFS, GeoJSON, GPX, GML e altri.</p>
<p>Leggi di più su <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code>:</p>
<ul class="simple">
<li><p>Repository: <a class="reference external" href="https://github.com/pramsey/pgsql-ogr-fdw">https://github.com/pramsey/pgsql-ogr-fdw</a></p></li>
<li><p>Nuovo e migliorato: <a class="reference external" href="http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html">http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html</a></p></li>
</ul>
<p class="rubric">Installa l’estensione <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code> nel tuo database.</p>
<p>Sul prompt del database digita:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">ogr_fdw</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Verifica quali formati sono supportati:</p>
<p>Apri un terminale e cerca ogr_fdw_info:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">locate</span> <span class="n">ogr_fdw_info</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ogr_fdw_info</span> <span class="o">-</span><span class="n">f</span>
</pre></div>
</div>
<p>I risultati potrebbero essere come questi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Supported</span> <span class="n">Formats</span><span class="p">:</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;OGR_GRASS&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PCIDSK&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;netCDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;JP2OpenJPEG&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MBTiles&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;EEDA&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;ESRI Shapefile&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MapInfo File&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">....</span> <span class="n">many</span> <span class="n">more</span>
</pre></div>
</div>
<p class="rubric">Crea un FDW per un WFS</p>
<p>Avvia Geoserver via <span class="menuselection">Geospatial ‣ Web Services ‣ GeoServer ‣  Start GeoServer</span></p>
<ul class="simple">
<li><p>Open GeoServer <a class="reference external" href="http://localhost:8082/geoserver/web/">http://localhost:8082/geoserver/web/</a></p></li>
<li><p>GeoServer WFS GetCapabilities <a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities</a></p></li>
<li><p>GeoServer WFS DescribeFeatureType for topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states</a></p></li>
<li><p>GeoServer WFS GetFeature topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states</a></p></li>
</ul>
<p class="rubric">Crea un server foreign che si riferisce al WFS che si vuole connettere</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
<span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">ogr_fdw</span>
<span class="n">OPTIONS</span> <span class="p">(</span> <span class="n">datasource</span> <span class="s1">&#39;WFS:http://localhost:8082/geoserver/ows&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="s1">&#39;WFS&#39;</span> <span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Importa tutti i feature_types WFS come tabelle foreign con un solo comando.</p>
<p>Dopo l’importazione vedrai diverse nuove tabelle foreign nel tuo schema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">ogr_all</span>
<span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
   <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Ispeziona la tabella dei dati foreign <code class="docutils literal notranslate"><span class="pre">topp_states</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">topp_states</span> <span class="n">WHERE</span> <span class="n">state_name</span> <span class="o">=</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="things-to-try">
<h2><a class="toc-backref" href="#id14">Cose da provare</a><a class="headerlink" href="#things-to-try" title="Link a questa intestazione">¶</a></h2>
<p>Ecco alcune sfide aggiuntive da provare:</p>
<ul class="simple">
<li><p>Prova alcune altre funzioni spaziali come <code class="docutils literal notranslate"><span class="pre">st_buffer(geom)</span></code>, <code class="docutils literal notranslate"><span class="pre">st_transform(geom,25831)</span></code>, <code class="docutils literal notranslate"><span class="pre">st_x(geom)</span></code> - troverai la documentazione completa su <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></p></li>
<li><p>Esporta le tue tabelle in shapefiles con <code class="docutils literal notranslate"><span class="pre">pgsql2shp</span></code> sulla linea di comando.</p></li>
<li><p>Prova <code class="docutils literal notranslate"><span class="pre">ogr2ogr</span></code> sulla linea di comando per importare/esportare dati nel tuo database.</p></li>
<li><p>Prova a importare i dati con <code class="docutils literal notranslate"><span class="pre">shp2pgsql</span></code> sulla linea di comando nel tuo database.</p></li>
<li><p>Prova ad eseguire routing stradale usando <a class="reference internal" href="../overview/pgrouting_overview.html"><span class="doc">pgRouting</span></a>.</p></li>
</ul>
</section>
<section id="what-next">
<h2><a class="toc-backref" href="#id15">E ora?</a><a class="headerlink" href="#what-next" title="Link a questa intestazione">¶</a></h2>
<p>Questo è solo il primo passo sulla strada per usare PostGIS. Ci sono molte altre funzionalità che puoi provare.</p>
<ul class="simple">
<li><p>Sito web del Progetto PostGIS - <a class="reference external" href="http://postgis.net">http://postgis.net</a></p></li>
<li><p>PostGIS Documentazione -  <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>



        
        
<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>
        


  </body>
</html>
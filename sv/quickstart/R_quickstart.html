
<!DOCTYPE html>

<html lang="sv">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>R Snabbstart &#8212; OSGeoLive 17.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/overview.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/../_themes/overview/static/overview.css" />
    <script data-url_root="../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Sök" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="XyGrib" href="../overview/xygrib_overview.html" />
    <link rel="prev" title="R" href="../overview/R_overview.html" />
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>


  </head><body>

        
        
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/osgeolive-banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
    </div>
        


    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('sv')">Svenska</a>
		</div>
	</font>
    </div>

  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="https://cran.r-project.org"><img alt="../../_images/logo_R.png" class="align-right" src="../../_images/logo_R.png" /></a>
<section id="r-quickstart">
<h1>R Snabbstart<a class="headerlink" href="#r-quickstart" title="Permalink till denna rubrik">¶</a></h1>
<p>R är en fri mjukvarumiljö för statistiska beräkningar och grafik.</p>
<p>Denna snabbstart beskriver hur du gör:</p>
<blockquote>
<div><ul class="simple">
<li><p>använda R för enkel aritmetik</p></li>
<li><p>ladda data från en shapefil och kartlägga den</p></li>
<li><p>göra en koordinattransformation</p></li>
<li><p>plotta några datapunkter på en karta</p></li>
</ul>
</div></blockquote>
<div class="contents local topic" id="contents">
<p class="topic-title">Innehåll</p>
<ul class="simple">
<li><p><a class="reference internal" href="#start-r" id="id1">Starta R</a></p></li>
<li><p><a class="reference internal" href="#building-data" id="id2">Byggnadsdata</a></p></li>
<li><p><a class="reference internal" href="#loading-map-data" id="id3">Ladda kartdata</a></p></li>
<li><p><a class="reference internal" href="#vignettes" id="id4">Vinjetter</a></p></li>
<li><p><a class="reference internal" href="#what-next" id="id5">Hur vill du gå vidare?</a></p></li>
</ul>
</div>
<section id="start-r">
<h2><a class="toc-backref" href="#id1">Starta R</a><a class="headerlink" href="#start-r" title="Permalink till denna rubrik">¶</a></h2>
<p>R är i huvudsak ett kommandoradsprogram, även om grafiska användargränssnitt finns tillgängliga. Du skriver en kodrad vid prompten, trycker på retur, och R-tolken utvärderar den och skriver ut resultatet.</p>
<div class="admonition tip">
<p class="admonition-title">Tips</p>
<p>Var inte rädd för kommandoraden - den är en källa till stor kraft. Använd upp- och nedpilarna för att återkalla kommandon så att du kan redigera misstag. Tryck på CTRL-C om du fastnar och du bör få tillbaka prompten.</p>
</div>
<p>Välj <span class="menuselection">Geospatial ‣ Spatial Tools ‣ R Statistics</span>. Ett terminalfönster öppnas där R körs.</p>
<p>Du kan börja med enkel aritmetik.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="mi">3</span><span class="o">*</span><span class="mi">2</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">6</span>

<span class="o">&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">4</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">2.5</span>

<span class="o">&gt;</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.414214</span>

<span class="o">&gt;</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.155727</span>
</pre></div>
</div>
<p>Ett komplett utbud av aritmetiska, trigonometriska och statistiska funktioner är inbyggda och tusentals fler finns tillgängliga från paket i arkivet <a class="reference external" href="https://cran.r-project.org/">CRAN</a>.</p>
<p>Huvudprompten i R är <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, men det finns också en fortsättningsprompt <code class="docutils literal notranslate"><span class="pre">+</span></code>, som visas om R förväntar sig mer inmatning för att skapa ett giltigt uttryck. Du ser det här om du glömmer en avslutande parentes eller klammer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">sqrt</span><span class="p">(</span>
<span class="o">+</span> <span class="mi">2</span>
<span class="o">+</span> <span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.414214</span>
</pre></div>
</div>
</section>
<section id="building-data">
<h2><a class="toc-backref" href="#id2">Byggnadsdata</a><a class="headerlink" href="#building-data" title="Permalink till denna rubrik">¶</a></h2>
<p>Du kanske undrar vad det mystiska ”ett” inom hakparentes gör i utmatningen. Detta talar om för dig att resultatet är ett tal. R kan lagra saker i endimensionella vektorer, tvådimensionella matriser och flerdimensionella matriser. Det finns många funktioner som kan generera dessa saker. Här är en enkel sekvens:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mf">1.000000</span> <span class="mf">1.444444</span> <span class="mf">1.888889</span> <span class="mf">2.333333</span> <span class="mf">2.777778</span> <span class="mf">3.222222</span> <span class="mf">3.666667</span> <span class="mf">4.111111</span>
<span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="mf">4.555556</span> <span class="mf">5.000000</span>
</pre></div>
</div>
<p>Nu kan du se att <code class="docutils literal notranslate"><span class="pre">[9]</span></code> talar om för oss att 4,555 är det nionde värdet i vektorn.</p>
<p>Om du konstruerar en matris får du rad- och kolumnbeteckningar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">m</span>
     <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span> <span class="p">[,</span><span class="mi">3</span><span class="p">]</span> <span class="p">[,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="mi">1</span>    <span class="mi">4</span>    <span class="mi">7</span>   <span class="mi">10</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mi">2</span>    <span class="mi">5</span>    <span class="mi">8</span>   <span class="mi">11</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="mi">3</span>    <span class="mi">6</span>    <span class="mi">9</span>   <span class="mi">12</span>
</pre></div>
</div>
<p>Element i matriser kan extraheras med hjälp av hakparenteser, med rad- och kolumnindex åtskilda med kommatecken. Lämna ett index tomt för att få en hel rad som en vektor. Använd ett vektorindex för att få flera rader eller kolumner som en mindre matris:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="mi">11</span>

<span class="o">&gt;</span> <span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="mi">2</span>  <span class="mi">5</span>  <span class="mi">8</span> <span class="mi">11</span>

<span class="o">&gt;</span> <span class="n">m</span><span class="p">[,</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
     <span class="p">[,</span><span class="mi">1</span><span class="p">]</span> <span class="p">[,</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,]</span>    <span class="mi">7</span>   <span class="mi">10</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,]</span>    <span class="mi">8</span>   <span class="mi">11</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,]</span>    <span class="mi">9</span>   <span class="mi">12</span>
</pre></div>
</div>
<p>Dataramar är datastrukturer som speglar den typ av struktur som finns i en RDBMS som Postgres eller MySQL. Varje rad kan betraktas som en post, medan kolumnerna är som fält i en databas. Precis som i en databas måste varje fält vara av samma typ för varje post.</p>
<p>På många sätt fungerar de som matriser, men du kan också få och ställa in kolumnerna med namn med hjälp av $-notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; d = data.frame(x=1:10, y=1:10, z=runif(10)) # z is 10 random numbers
&gt; d
        x  y          z
    1   1  1 0.44128080
    2   2  2 0.09394331
    3   3  3 0.51097462
    4   4  4 0.82683828
    5   5  5 0.21826740
    6   6  6 0.65600533
    7   7  7 0.59798278
    8   8  8 0.19003625
    9   9  9 0.24004866
    10 10 10 0.35972749

&gt; d$z
 [1] 0.44128080 0.09394331 0.51097462 0.82683828 0.21826740 0.65600533
 [7] 0.59798278 0.19003625 0.24004866 0.35972749

&gt; d$big = d$z &gt; 0.6  # d$big is now a boolean true/false value
&gt; d[1:5,]
  x y          z   big
1 1 1 0.44128080 FALSE
2 2 2 0.09394331 FALSE
3 3 3 0.51097462 FALSE
4 4 4 0.82683828  TRUE
5 5 5 0.21826740 FALSE

&gt; d$name = letters[1:10] # create a new field of characters
&gt; d[1:5,]
  x y          z   big name
  1 1 1 0.44128080 FALSE    a
  2 2 2 0.09394331 FALSE    b
  3 3 3 0.51097462 FALSE    c
  4 4 4 0.82683828  TRUE    d
  5 5 5 0.21826740 FALSE    e
</pre></div>
</div>
</section>
<section id="loading-map-data">
<h2><a class="toc-backref" href="#id3">Ladda kartdata</a><a class="headerlink" href="#loading-map-data" title="Permalink till denna rubrik">¶</a></h2>
<p>Det finns många paket för hantering av spatiala data och statistik. Vissa finns med här och andra kan laddas ner från CRAN.</p>
<p>Här kommer vi att ladda två shapefiler - landsgränser och befolkade platser från Natural Earth-data. Vi använder två tilläggspaket för att få den spatiala funktionaliteten:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>           <span class="c1"># Simple Features manipulation Library</span>
<span class="o">&gt;</span> <span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>      <span class="c1"># Plotting library</span>

<span class="o">&gt;</span> <span class="n">countries</span> <span class="o">&lt;-</span> <span class="n">st_read</span><span class="p">(</span><span class="n">dsn</span> <span class="o">=</span> <span class="s2">&quot;~/data/natural_earth2/ne_10m_admin_0_countries.shp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">places</span> <span class="o">&lt;-</span> <span class="n">st_read</span><span class="p">(</span><span class="n">dsn</span> <span class="o">=</span> <span class="s2">&quot;~/data/natural_earth2/ne_10m_populated_places.shp&quot;</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">countries</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_sf</span><span class="p">()</span>
</pre></div>
</div>
<p>Detta ger oss en enkel karta över världen:</p>
<img alt="../../_images/r_plot1.png" src="../../_images/r_plot1.png" />
<p>När en OGR-datauppsättning läses in i R på det här sättet får vi tillbaka ett objekt som på många sätt beter sig som en dataram. Vi kan använda fältet <code class="docutils literal notranslate"><span class="pre">admin</span></code> för att dela upp världsdata och bara få Storbritannien:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; uk &lt;- countries[countries$admin == &#39;United Kingdom&#39;,]
&gt; ggplot(uk) + geom_sf()
</pre></div>
</div>
<img alt="../../_images/r_plot2.png" src="../../_images/r_plot2.png" />
<p>Det här ser lite knasigt ut för alla som bor här, eftersom vi är mer bekanta med ett koordinatsystem som är centrerat kring vår latitud. För närvarande har objektet inte tilldelats något koordinatsystem.</p>
<p>Vi måste tilldela objektet en CRS innan vi kan transformera det med funktionen sf::st_transform från sf-paketet. Vi transformerar till EPSG:27700 som är Ordnance Survey of Great Britain grid system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">ukos</span> <span class="o">&lt;-</span> <span class="n">st_transform</span><span class="p">(</span><span class="n">uk</span><span class="p">,</span><span class="mi">27700</span><span class="p">)</span>
<span class="o">&gt;</span> <span class="n">ggplot</span><span class="p">(</span><span class="n">ukos</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_sf</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/r_plot2_1.png" src="../../_images/r_plot2_1.png" />
<p>Detta plottar baskartan för de transformerade uppgifterna. Nu vill vi lägga till några punkter från datauppsättningen med befolkade platser. Återigen väljer vi ut de punkter vi vill ha och omvandlar dem till koordinater för Ordnance Survey Grid Reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; ukpop &lt;- places[places$SOV0NAME == &#39;United Kingdom&#39;,]
&gt; ukpop &lt;- st_transform(ukpop,27700)
</pre></div>
</div>
<p>Vi lägger till dessa punkter på baskartan, skalar deras storlek med den skalade kvadratroten av befolkningen (eftersom det ger en symbol med en yta som är proportionell mot befolkningen), ställer in färgen på röd och plottningskaraktären på en solid klump:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; ggplot() +
&gt;   geom_sf(data = ukos) +                                                          # add UK shape to the map
&gt;   geom_sf(data = ukpop,                                                           # add the Populated places
&gt;           aes(size = ukpop$POP_MAX/100000),                       # fix size of points (by area)
&gt;           colour = &#39;red&#39;, alpha = 1/5) +                          # set points colour and transparency
&gt;   coord_sf(crs = 27700, datum= sf::st_crs(27700),         # set a bounding box
&gt;            xlim = st_bbox(ukos[c(1,3)]),                          # for the map
&gt;            ylim = st_bbox(ukos[c(2,4)])
&gt;           ) +
&gt;   ggtitle(&#39;Uk Population centre sizes&#39;) +                         # set the map title
&gt;       theme(legend.position = &#39;bottom&#39;) +                         # Legend position
&gt;           scale_size_area(name = &#39;Population \nin 100K&#39;)  # 0 value means 0 area + legend title
</pre></div>
</div>
<p>och vår slutliga bild visas:</p>
<img alt="../../_images/r_plot3.png" src="../../_images/r_plot3.png" />
<div class="admonition tip">
<p class="admonition-title">Tips</p>
<p>Avsluta R genom att skriva <code class="docutils literal notranslate"><span class="pre">q()</span></code> och trycka på returtangenten. R kommer att fråga dig om du vill spara din arbetsyta som en R data image-fil. När du startar R igen från en katalog med filen <code class="docutils literal notranslate"><span class="pre">.RData</span></code> återställer den alla data därifrån.</p>
</div>
</section>
<section id="vignettes">
<h2><a class="toc-backref" href="#id4">Vinjetter</a><a class="headerlink" href="#vignettes" title="Permalink till denna rubrik">¶</a></h2>
<p>Tidigare tenderade dokumentationen för R-paket att vara kortfattat skrivna hjälpsidor för varje funktion. Nu uppmuntras paketförfattare att skriva en ”vignette” som en vänlig introduktion till paketet. Om du kör funktionen <code class="docutils literal notranslate"><span class="pre">vignette()</span></code> utan argument får du en lista över de vinjetter som finns i ditt system. Prova <code class="docutils literal notranslate"><span class="pre">vignette(&quot;sf1&quot;)</span></code> för en något teknisk introduktion till R spatial-paketet.</p>
</section>
<section id="what-next">
<h2><a class="toc-backref" href="#id5">Hur vill du gå vidare?</a><a class="headerlink" href="#what-next" title="Permalink till denna rubrik">¶</a></h2>
<p>För allmän information om R, prova den officiella <a class="reference external" href="https://cran.r-project.org/doc/manuals/R-intro.html">Introduction to R</a> eller någon av dokumentationerna från huvudsidan för <a class="reference external" href="https://www.r-project.org/">R Project</a>.</p>
<p>För mer information om spatiala aspekter av R är det bästa stället att börja förmodligen <a class="reference external" href="https://cran.r-project.org/web/views/Spatial.html">R Spatial Task View</a></p>
<p>You might also want to check out the <a class="reference external" href="https://r-spatial.org">R-Spatial</a> and <a class="reference external" href="https://rspatial.org">RSpatial</a>
pages.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a> |   <a href="javascript:defaultRedirect('sv')">Svenska</a>
		</div>
	</font>
    </div>



        
        
<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>
        


  </body>
</html>
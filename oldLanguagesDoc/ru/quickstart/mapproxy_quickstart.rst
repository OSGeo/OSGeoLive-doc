:Author: Oliver Tonnhofer
:Version: osgeo-live5.0
:License: Creative Commons Attribution-ShareAlike 3.0 Unported  (CC BY-SA 3.0)

.. image:: ../../images/project_logos/logo-mapproxy.png
  :alt: логотип проекта
  :align: right
  :target: http://mapproxy.org/

Начало работы с MapProxy 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

MapProxy — "швейцарский армейский нож" для работы с WMS-сервисами и сервисами тайлирования.
Он кэширует и трансформирует данные уже существующих картографических сервисов, а также ускоряет доступ к ним.

.. image:: ../../images/screenshots/800x600/mapproxy.png
  :alt: диаграмма MapProxy
  :align: center

MapProxy — это не только кэширующий сервер тайлирования. Он предлагает множество новых и инновационных функций, таких, как полная поддержка WMS-клиентов.

Запуск демо-службы
--------------------------------------------------------------------------------

MapProxy имеет гибкие возможности развёртывания. К примеру, вы можете интегрировать его в веб-сервер Apache. Но вы можете запустить его и как самостоятельную службу, что будет лучшим вариантом для начала работы.

Для запуска MapProxy в виде самостоятельного сервиса нажмите :menuselection:`Geospatial --> Web Services --> MapProxy --> Start MapProxy`.


Просмотр демо MapProxy
--------------------------------------------------------------------------------

Демо-страница MapProxy содержит простейшие WMS-сервис и клиент для каждого преднастроенного слоя. Например, вы не сможете выбрать проекцию для WMS-слоя, но этого варианта достаточно для того, чтобы убедиться, что сервис работает.

Вы можете открыть демо-страницу в веб-браузере: `<http://localhost:8011/demo>`_

Просмотр в настольной ГИС
--------------------------------------------------------------------------------

Вы можете добавлять сервисы MapProxy в любую настольную ГИС: uDig, QGIS или gvSIG. Адрес сервиса: `<http://localhost:8011/service?>`_

Пример конфигурационного файла MapProxy содержит несколько слоёв, которые используют различные картографические движки и данные. Детальная информация о каждом слое приведена ниже.

.. figure:: ../../images/screenshots/800x600/mapproxy_udig.png
  :alt: пример MapProxy в uDig
  :align: center
  
Одиночный WMS-слой, с данными из двух каскадных сервисов и возможностью делать `FeatureInformation` запросы к одному из них.

Доступные слои
--------------------------------------------------------------------------------

**mapnik**:
  Карта населения мира, отрисованная Mapnik. Нет необходимости явно запускать сервис Mapnik, потому что этот слой может использовать интегрированную поддержку Mapnik в MapProxy.

**tilelite**:
  TileLite — простой сервер, предоставляющий тайлы с сервиса Mapnik "Карта населения мира". Этот слой демонстрирует возможность использования существующих тайловых сервисов в MapProxy и организации к ним доступа через WMS.
  Перед тем, как использовать этот слой, вам необходимо запустить TileLite, вызвав *Start Mapnik & TileLite*.

**geoserver**:
  Карта населения US, отрисованная :doc:`GeoServer <../overview/geoserver_overview>` из WMS. Этот слой поддерживает ``GetFeatureInfo`` запросы, которые каскадно перенаправляются на базовый сервис.
  Перед тем, как использовать этот слой, вам необходимо запустить GeoServer: |osgeolive-appmenupath-geoserver|.

**mapnik_geoserver**:
  Этот слой демонстрирует возможность объединения нескольких источников в один слой. Он объединяет карту карту населения мира, отрисованную Mapnik, и карту населения US с GeoServer. Запросы ``GetFeatureInfo`` к карте населения US всё так же работают.
  Перед тем, как использовать этот слой, вам необходимо запустить GeoServer: |osgeolive-appmenupath-geoserver|. 

**mapserver**:
  Этот слой использует демонстрационный набор данных *Mapserver Itasca*. Это локальный набор, и для него используется функция ограничения пространственных охватом *Itasca, IL*.


Создание собственной конфигурации
--------------------------------------------------------------------------------

Вы можете использовать ``mapproxy-util`` для создания нового шаблона конфигурации и запуска тестового сервера.

Для создания конфигурации::

  mapproxy-util create -t base-config ~/mapproxy

Для запуска тестового сервера, прослушивающего порт *8011*, на базе созданного конфигурационного файла::

  mapproxy-util serve-develop ~/mapproxy/mapproxy.yaml -b 0.0.0.0:8011

Теперь вы можете открыть демо-страницу по адресу http://127.0.0.1:8011/demo/.
Тестовый сервер MapProxy автоматически перезагружается, если вы измените свой конфигурационный файл.


Что дальше?
--------------------------------------------------------------------------------

* Прочитайте `документацию по MapProxy <../../mapproxy/index.html>`_

* Посмотрите пример конфигурационного файла (``/usr/local/share/mapproxy/mapproxy.yaml``)



<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>PostGIS Quickstart &#8212; OSGeoLive 15.0 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/overview.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/../_themes/overview/static/overview.css" />
    <script data-url_root="../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="pgRouting" href="../overview/pgrouting_overview.html" />
    <link rel="prev" title="PostGIS" href="../overview/postgis_overview.html" />
	<script type="text/javascript" src="../../_static/osgeolive.js"></script>


  </head><body>

        
        
    <div class="header">
	<div class="banner"><a href="http://live.osgeo.org/"><img src="../../_images/osgeolive-banner.png"></a></div>
        <div class="nowrap">
            <ul id="top-nav">
              <li><a href="../index.html">Home</a></li>
              <li><a href="../overview/overview.html">Contents</a></li>
              <li><a href="../download.html">Download</a></li>
              <li><a href="../metrics.html">Metrics</a></li>
              <li><a href="../sponsors.html">Sponsors</a></li>
              <li><a href="../contact.html">Contact Us</a></li>
            </ul>
        </div>
    </div>
    </div>
        


    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>

  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <a class="reference external image-reference" href="http://postgis.net"><img alt="../../_images/logo_postgis.png" class="align-right" src="../../_images/logo_postgis.png" /></a>
<a class="reference external image-reference" href="https://www.osgeo.org"><img alt="../../_images/OSGeo_project.png" class="align-right" src="../../_images/OSGeo_project.png" /></a>
<section id="postgis-quickstart">
<h1>PostGIS Quickstart<a class="headerlink" href="#postgis-quickstart" title="Permalink to this headline">¶</a></h1>
<p>PostGIS adds spatial capabilities to the PostgreSQL relational database. It extends
PostgreSQL so it can store, query, and manipulate spatial data. In this Quickstart we will
use ‘PostgreSQL’ when describing general database functions, and ‘PostGIS’ when
describing the additional spatial functionality provided by PostGIS.</p>
<p>This Quick Start describes how to:</p>
<blockquote>
<div><ul class="simple">
<li><p>Create and query a spatial database from the command line and <a class="reference internal" href="../overview/qgis_overview.html"><span class="doc">QGIS</span></a> graphical client.</p></li>
<li><p>Manage data from the <code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code> client.</p></li>
</ul>
</div></blockquote>
<div class="contents local topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#client-server-architecture" id="id1">Client-server architecture</a></p></li>
<li><p><a class="reference internal" href="#creating-a-spatially-enabled-database" id="id2">Creating a spatially-enabled database</a></p></li>
<li><p><a class="reference internal" href="#creating-a-spatial-table-using-sql" id="id3">Creating a Spatial Table using SQL</a></p></li>
<li><p><a class="reference internal" href="#simple-queries" id="id4">Simple queries</a></p></li>
<li><p><a class="reference internal" href="#spatial-queries" id="id5">Spatial queries</a></p></li>
<li><p><a class="reference internal" href="#mapping" id="id6">Mapping</a></p></li>
<li><p><a class="reference internal" href="#importing-spatial-data-into-the-database" id="id7">Importing spatial data into the database</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-phppgadmin-iso-vmdk" id="id8">Get to know phpPgAdmin (ISO &amp; VMDK)</a></p></li>
<li><p><a class="reference internal" href="#executing-a-sql-query-from-phppgadmin-iso-vmdk" id="id9">Executing a SQL query from phpPgAdmin (ISO &amp; VMDK)</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-pgadmin-vmdk-only" id="id10">Get to know pgAdmin (VMDK only)</a></p></li>
<li><p><a class="reference internal" href="#executing-a-sql-query-from-pgadmin-vmdk-only" id="id11">Executing a SQL query from pgAdmin (VMDK only)</a></p></li>
<li><p><a class="reference internal" href="#get-to-know-foreign-data-wrappers-fdw" id="id12">Get to know Foreign Data Wrappers (FDW)</a></p></li>
<li><p><a class="reference internal" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" id="id13">Connect to a remote OGR data source via ogr_fdw</a></p></li>
<li><p><a class="reference internal" href="#things-to-try" id="id14">Things to try</a></p></li>
<li><p><a class="reference internal" href="#what-next" id="id15">What next?</a></p></li>
</ul>
</div>
<section id="client-server-architecture">
<h2><a class="toc-backref" href="#id1">Client-server architecture</a><a class="headerlink" href="#client-server-architecture" title="Permalink to this headline">¶</a></h2>
<p>PostgreSQL, like many databases, works as a server in a client-server system.
The client makes a request to the server and gets back a response. This is the
same way that the internet works - your browser is a client and a web server sends
back the web page. With PostgreSQL the requests are in the SQL language and the
response is usually a table of data from the database.</p>
<p>There is nothing to stop the server being on the same computer as the client, and this
enables you to use PostgreSQL on a single machine. Your client connects to the server
via the internal ‘loopback’ network connection, and is not visible to other computers
unless you configure it to be so.</p>
</section>
<section id="creating-a-spatially-enabled-database">
<h2><a class="toc-backref" href="#id2">Creating a spatially-enabled database</a><a class="headerlink" href="#creating-a-spatially-enabled-database" title="Permalink to this headline">¶</a></h2>
<p>Command-line clients run from within a Terminal Emulator window.</p>
<p>Start a Terminal Emulator (LXTerminal currently) from the Applications menu in the Accessories section. This gives you a Unix shell command prompt. Type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">V</span>
</pre></div>
</div>
<p>and hit enter to see the PostgreSQL version number.</p>
<p>A single PostgreSQL server lets you organise work by arranging it into separate
databases. Each database is an independent regime, with its own tables, views, users
and so on. When you connect to a PostgreSQL server you have to specify a
database.</p>
<p>You can get a list of databases on the server with the:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psql</span> <span class="o">-</span><span class="n">l</span>
</pre></div>
</div>
<p>command. You should see several databases used by some of the projects on the system.
We will create a new one for this quickstart.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The list uses a standard unix pager - hit space for next page, <kbd class="kbd docutils literal notranslate">b</kbd> to go back, <kbd class="kbd docutils literal notranslate">q</kbd>
to quit, h for help.</p>
</div>
<p>PostgreSQL gives us a utility program for creating databases, <code class="docutils literal notranslate"><span class="pre">createdb</span></code>. We need to
create a database before adding the PostGIS extensions. We’ll call our database <code class="docutils literal notranslate"><span class="pre">demo</span></code>.
The command is then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">createdb</span> <span class="n">demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can usually get help for command line tools by using a <code class="docutils literal notranslate"><span class="pre">--help</span></code> option.</p>
</div>
<p>If you now run <code class="docutils literal notranslate"><span class="pre">psql</span> <span class="pre">-l</span></code> you should see your <code class="docutils literal notranslate"><span class="pre">demo</span></code> database in the listing.
We have not added the PostGIS extension yet, but in the next section you will learn how.</p>
<p>You can create PostGIS databases using the SQL language. First we’ll delete the
database we just created using the <code class="docutils literal notranslate"><span class="pre">dropdb</span></code> command, then use the <code class="docutils literal notranslate"><span class="pre">psql</span></code> command
to get an SQL command interpreter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dropdb</span> <span class="n">demo</span>
<span class="n">psql</span> <span class="o">-</span><span class="n">d</span> <span class="n">postgres</span>
</pre></div>
</div>
<p>This connects to the core system database called <code class="docutils literal notranslate"><span class="pre">postgres</span></code>.
Now enter the SQL to create a new database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># CREATE DATABASE demo;</span>
</pre></div>
</div>
<p>Now switch your connection from the <code class="docutils literal notranslate"><span class="pre">postgres</span></code> database to the new <code class="docutils literal notranslate"><span class="pre">demo</span></code> database.
In the future you can connect to it directly with <code class="docutils literal notranslate"><span class="pre">psql</span> <span class="pre">-d</span> <span class="pre">demo</span></code>, but here’s a neat
way of switching within the <code class="docutils literal notranslate"><span class="pre">psql</span></code> command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># \c demo</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Hit <kbd class="kbd docutils literal notranslate">CTRL</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd> if the psql prompt keeps appearing after pressing return. It will clear your
input and start again. It is probably waiting for a closing quote mark, semicolon, or something.</p>
</div>
<p>You should see an informational message, and the prompt will change to show that you are now
connected to the <code class="docutils literal notranslate"><span class="pre">demo</span></code> database.</p>
<p>Next, add PostGIS extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># create extension postgis;</span>
</pre></div>
</div>
<p>To verify you have postgis now installed, run the following query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT postgis_version();</span>

           <span class="n">postgis_version</span>
<span class="o">---------------------------------------</span>
 <span class="mf">2.3</span> <span class="n">USE_GEOS</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_PROJ</span><span class="o">=</span><span class="mi">1</span> <span class="n">USE_STATS</span><span class="o">=</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS installs many functions, a table, and several views</p>
<p>Type <code class="docutils literal notranslate"><span class="pre">\dt</span></code> to list the
tables in the database. You should see something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dt</span>
             <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>       <span class="o">|</span> <span class="n">Type</span>  <span class="o">|</span> <span class="n">Owner</span>
<span class="o">--------+------------------+-------+-------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">spatial_ref_sys</span>  <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">user</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">spatial_ref_sys</span></code> table is used by PostGIS for converting between different spatial reference systems.
The <code class="docutils literal notranslate"><span class="pre">spatial_ref_sys</span></code> table stores information
on valid spatial reference systems, and we can use some SQL to have a quick look:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT srid, auth_name, proj4text FROM spatial_ref_sys LIMIT 10;</span>

 <span class="n">srid</span> <span class="o">|</span> <span class="n">auth_name</span> <span class="o">|</span>          <span class="n">proj4text</span>
<span class="o">------+-----------+--------------------------------------</span>
 <span class="mi">3819</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">towgs</span><span class="o">...</span>
 <span class="mi">3821</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">3824</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3889</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">GRS80</span> <span class="o">+</span><span class="n">towgs8</span><span class="o">...</span>
 <span class="mi">3906</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4001</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">airy</span> <span class="o">+</span><span class="n">no_defs</span><span class="o">...</span>
 <span class="mi">4002</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377340.189</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
 <span class="mi">4003</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">aust_SA</span> <span class="o">+</span><span class="n">no_d</span><span class="o">...</span>
 <span class="mi">4004</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">ellps</span><span class="o">=</span><span class="n">bessel</span> <span class="o">+</span><span class="n">no_de</span><span class="o">...</span>
 <span class="mi">4005</span> <span class="o">|</span> <span class="n">EPSG</span>      <span class="o">|</span> <span class="o">+</span><span class="n">proj</span><span class="o">=</span><span class="n">longlat</span> <span class="o">+</span><span class="n">a</span><span class="o">=</span><span class="mf">6377492.018</span> <span class="o">+</span><span class="n">b</span><span class="o">=</span><span class="mf">63.</span><span class="o">..</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>This confirms we have a spatially-enabled database.</p>
<p>In addition to this table, you’ll find several views created when you enable postgis in your database.</p>
<p>Type <code class="docutils literal notranslate"><span class="pre">\dv</span></code> to list the
views in the database. You should see something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># \dv</span>
                                                                <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>       <span class="n">Name</span>        <span class="o">|</span> <span class="n">Type</span> <span class="o">|</span>  <span class="n">Owner</span>
<span class="o">--------+-------------------+------+----------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geography_columns</span> <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">geometry_columns</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_columns</span>    <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">raster_overviews</span>  <span class="o">|</span> <span class="n">view</span> <span class="o">|</span> <span class="n">postgres</span>
<span class="p">(</span><span class="mi">4</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>PostGIS supports several spatial data types:</p>
<blockquote>
<div><p><cite>geometry</cite> - is a data type that stores data as vectors drawn on a flat surface</p>
<p><cite>geography</cite> - is a data type that stores data as vectors drawn on a spheroidal surface</p>
<dl class="simple">
<dt><cite>raster</cite> - is a data type that stores data as an n-dimensional matrix where each position (pixel) represents</dt><dd><p>an area of space, and each band (dimension) has a value for each pixel space.</p>
</dd>
</dl>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">geometry_columns</span></code>, <code class="docutils literal notranslate"><span class="pre">geography_columns</span></code>, and <code class="docutils literal notranslate"><span class="pre">raster_columns</span></code> views have the
job of telling PostGIS which tables have PostGIS geometry, geography, and raster columns.</p>
<p>Overviews are lower resolution tables for raster data.
The <code class="docutils literal notranslate"><span class="pre">raster_overviews</span></code> lists such tables and their raster column and the table each is an overview for.
Raster overview tables are used by tools such as QGIS to provide lower resolution versions of raster data for faster loading.</p>
<p>PostGIS geometry type is the first and still most popular type used by PostGIS users.
We’ll be focussing our attention on that type.</p>
</section>
<section id="creating-a-spatial-table-using-sql">
<h2><a class="toc-backref" href="#id3">Creating a Spatial Table using SQL</a><a class="headerlink" href="#creating-a-spatial-table-using-sql" title="Permalink to this headline">¶</a></h2>
<p>Now we have a spatial database we can make some spatial tables.</p>
<p>First we create an ordinary database table to store some city data.
This table has three fields - one for a numeric ID identifying the city,
one for the city name, and another for the geometry column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># CREATE TABLE cities ( id int4 primary key, name varchar(50), geom geometry(POINT,4326) );</span>
</pre></div>
</div>
<p>Conventionally this geometry column is named
<code class="docutils literal notranslate"><span class="pre">geom</span></code> (the older PostGIS convention was <code class="docutils literal notranslate"><span class="pre">the_geom</span></code>). This tells PostGIS what kind of geometry
each feature has (points, lines, polygons etc), how many dimensions
(in this case 2, if it had 3 or 4 dimensions we would use POINTZ, POINTM, or POINTZM), and the spatial reference
system. We used EPSG:4326 coordinates for our cities.</p>
<p>Now if you check the cities table you should see the new column, and be informed
that the table currently contains no rows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * from cities;</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span> <span class="o">|</span> <span class="n">geom</span>
<span class="o">----+------+----------</span>
<span class="p">(</span><span class="mi">0</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>To add rows to the table we use some SQL statements. To get the geometry into
the geometry column we use the PostGIS <code class="docutils literal notranslate"><span class="pre">ST_GeomFromText</span></code> function to convert
from a text format that gives the coordinates and a spatial reference system id:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (1,ST_GeomFromText(&#39;POINT(-0.1257 51.508)&#39;,4326),&#39;London, England&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (2,ST_GeomFromText(&#39;POINT(-81.233 42.983)&#39;,4326),&#39;London, Ontario&#39;);</span>
<span class="n">demo</span><span class="o">=</span><span class="c1"># INSERT INTO cities (id, geom, name) VALUES (3,ST_GeomFromText(&#39;POINT(27.91162491 -33.01529)&#39;,4326),&#39;East London,SA&#39;);</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Use the arrow keys to recall and edit command lines.</p>
</div>
<p>As you can see this gets increasingly tedious very quickly. Luckily there are other ways of getting
data into PostGIS tables that are much easier. But now we have three cities in our database, and we
can work with that.</p>
</section>
<section id="simple-queries">
<h2><a class="toc-backref" href="#id4">Simple queries</a><a class="headerlink" href="#simple-queries" title="Permalink to this headline">¶</a></h2>
<p>All the usual SQL operations can be applied to select data from a PostGIS table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT * FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span>                      <span class="n">geom</span>
<span class="o">----+-----------------+----------------------------------------------------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">BBB88D06F016C0BF1B2FDD2406C14940</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="mf">0101000020E6100000</span><span class="n">F4FDD478E94E54C0E7FBA9F1D27D4540</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="mf">0101000020E610000040</span><span class="n">AB064060E93B4059FAD005F58140C0</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives us an encoded hexadecimal version of the coordinates, not so useful for humans.</p>
<p>If you want to have a look at your geometry in WKT format again, you
can use the functions ST_AsText(geom) or ST_AsEwkt(geom). You can also
use ST_X(geom), ST_Y(geom) to get the numeric value of the coordinates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT id, ST_AsText(geom), ST_AsEwkt(geom), ST_X(geom), ST_Y(geom) FROM cities;</span>
 <span class="nb">id</span> <span class="o">|</span>          <span class="n">st_astext</span>           <span class="o">|</span>               <span class="n">st_asewkt</span>                <span class="o">|</span>    <span class="n">st_x</span>     <span class="o">|</span>   <span class="n">st_y</span>
<span class="o">----+------------------------------+----------------------------------------+-------------+-----------</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1257</span> <span class="mf">51.508</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">0.1257</span> <span class="o">|</span>    <span class="mf">51.508</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="o">-</span><span class="mf">81.233</span> <span class="mf">42.983</span><span class="p">)</span>        <span class="o">|</span>     <span class="o">-</span><span class="mf">81.233</span> <span class="o">|</span>    <span class="mf">42.983</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="n">SRID</span><span class="o">=</span><span class="mi">4326</span><span class="p">;</span><span class="n">POINT</span><span class="p">(</span><span class="mf">27.91162491</span> <span class="o">-</span><span class="mf">33.01529</span><span class="p">)</span> <span class="o">|</span> <span class="mf">27.91162491</span> <span class="o">|</span> <span class="o">-</span><span class="mf">33.01529</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-queries">
<h2><a class="toc-backref" href="#id5">Spatial queries</a><a class="headerlink" href="#spatial-queries" title="Permalink to this headline">¶</a></h2>
<p>PostGIS adds many functions with spatial functionality to
PostgreSQL. We’ve already seen ST_GeomFromText which converts WKT to
geometry. Most of them start with ST (for spatial type) and are listed in a section of
the PostGIS documentation. We’ll now use one to answer a practical
question - how far are these three Londons away from each other, in metres,
assuming a spherical earth?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSphere(p1.geom,p2.geom) FROM cities AS p1, cities AS p2 WHERE p1.id &gt; p2.id;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancesphere</span>
<span class="o">-----------------+-----------------+--------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">5875766.85191657</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>   <span class="mf">9789646.96784908</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>   <span class="mf">13892160.9525778</span>
 <span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives us the distance, in metres, between each pair of
cities. Notice how the ‘WHERE’ part of the line stops us getting back
distances of a city to itself (which will all be zero) or the reverse
distances to the ones in the table above (London, England to London, Ontario is the
same distance as London, Ontario to London, England). Try it without the ‘WHERE’ part
and see what happens.</p>
<p>We can also compute the distance using a spheroid by using a different function and specifying the
spheroid name, semi-major axis and inverse flattening parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">demo</span><span class="o">=</span><span class="c1"># SELECT p1.name,p2.name,ST_DistanceSpheroid(</span>
        <span class="n">p1</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span><span class="n">p2</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="s1">&#39;SPHEROID[&quot;GRS_1980&quot;,6378137,298.257222]&#39;</span>
        <span class="p">)</span>
       <span class="n">FROM</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p1</span><span class="p">,</span> <span class="n">cities</span> <span class="n">AS</span> <span class="n">p2</span> <span class="n">WHERE</span> <span class="n">p1</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="o">.</span><span class="n">id</span><span class="p">;</span>
      <span class="n">name</span>       <span class="o">|</span>      <span class="n">name</span>       <span class="o">|</span> <span class="n">st_distancespheroid</span>
<span class="o">-----------------+-----------------+----------------------</span>
 <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">5892413.63776489</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">England</span> <span class="o">|</span>     <span class="mf">9756842.65711931</span>
 <span class="n">East</span> <span class="n">London</span><span class="p">,</span><span class="n">SA</span>  <span class="o">|</span> <span class="n">London</span><span class="p">,</span> <span class="n">Ontario</span> <span class="o">|</span>     <span class="mf">13884149.4140698</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>To quit PostgreSQL command line, enter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">q</span>
</pre></div>
</div>
<p>You are now back to system console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@osgeolive:~$
</pre></div>
</div>
</section>
<section id="mapping">
<h2><a class="toc-backref" href="#id6">Mapping</a><a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h2>
<p>To produce a map from PostGIS data, you need a client that can get at the data. Most
of the open source desktop GIS programs can do this - QGIS, gvSIG, uDig for example. Now we’ll
show you how to make a map from QGIS.</p>
<p>Start QGIS from the Desktop GIS menu and choose <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">PostGIS</span> <span class="pre">layers</span></code> from the layer menu. The
parameters for connecting to the Natural Earth data in PostGIS are already defined in the Connections
drop-down menu. You can define new server connections here, and store the settings for easy
recall. Click on Connections drop down menu and choose Natural Earth. Hit <code class="docutils literal notranslate"><span class="pre">Edit</span></code> if you want to see what those parameters are for Natural Earth, or just
hit <code class="docutils literal notranslate"><span class="pre">Connect</span></code> to continue:</p>
<a class="reference internal image-reference" href="../../_images/postgis_addlayers.png"><img alt="Connect to Natural Earth" class="align-center" src="../../_images/postgis_addlayers.png" style="width: 705.75px; height: 254.25px;" /></a>
<p>You will now get a list of the spatial tables in the database:</p>
<a class="reference internal image-reference" href="../../_images/postgis_listtables.png"><img alt="Natural Earth Layers" class="align-center" src="../../_images/postgis_listtables.png" style="width: 709.5px; height: 394.5px;" /></a>
<p>Choose the ne_10m_lakes table and hit <code class="docutils literal notranslate"><span class="pre">Add</span></code> at the bottom (not <code class="docutils literal notranslate"><span class="pre">Load</span></code> at the
top - that loads database connection parameters), and it should be
loaded into QGIS:</p>
<a class="reference internal image-reference" href="../../_images/postgis_lakesmap.png"><img alt="My First PostGIS layer" class="align-center" src="../../_images/postgis_lakesmap.png" style="width: 1029.0px; height: 605.25px;" /></a>
<p>You should now see a map of the lakes. QGIS doesn’t know they are lakes, so might not colour
them blue for you - use the QGIS documentation to work out how to change this. Zoom in to
a famous group of lakes in Canada.</p>
</section>
<section id="importing-spatial-data-into-the-database">
<h2><a class="toc-backref" href="#id7">Importing spatial data into the database</a><a class="headerlink" href="#importing-spatial-data-into-the-database" title="Permalink to this headline">¶</a></h2>
<p>Most of the OSGeo desktop tools have functions for importing spatial data from other formats (f.e. ESRI Shape) into the database. Again we’ll use QGIS to show this.</p>
<p>Importing shapefiles to QGIS can be done via the handy QGIS Database Manager. You find the manager in the menu. Go to <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">-&gt;</span> <span class="pre">DB</span> <span class="pre">Manager</span></code>.</p>
<p>Deploys the Postgis item, then the NaturalEarth item. It will then  connect to the Natural Earth database. Leave
the password blank if it asks. In the public item, there is the list of the layers provided by the database. You’ll see the main manager window. On the left you can select
tables from the database and use the tabs on the right find out about them. The Preview tab
will show you a little map.</p>
<a class="reference internal image-reference" href="../../_images/postgis_managerpreview.png"><img alt="QGIS Manager Preview" class="align-center" src="../../_images/postgis_managerpreview.png" style="width: 929.25px; height: 599.25px;" /></a>
<p>We will now use the DB Manager to import a shapefile into the database. We’ll use
the North Carolina sudden infant death syndrome (SIDS) data that is included with one
of the R statistics package add-ons.</p>
<p>From the <code class="docutils literal notranslate"><span class="pre">Table</span></code> menu choose the <code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">layer/file</span></code> option.
Hit the <code class="docutils literal notranslate"><span class="pre">...</span></code> button and browse to the <code class="docutils literal notranslate"><span class="pre">sids.shp</span></code> shapefile in the R directory.
(located in /home/user/data/vector/R/shapes):</p>
<a class="reference internal image-reference" href="../../_images/postgis_browsedata.png"><img alt="Find the shapefile" class="align-center" src="../../_images/postgis_browsedata.png" style="width: 631.5px; height: 312.0px;" /></a>
<p>Leave everything else as it is and hit <code class="docutils literal notranslate"><span class="pre">Load</span></code></p>
<a class="reference internal image-reference" href="../../_images/postgis_importsids.png"><img alt="Import a shapefile" class="align-center" src="../../_images/postgis_importsids.png" style="width: 346.5px; height: 400.5px;" /></a>
<p>Let the Coordinate Reference System Selector default to (WGS 84 EPSG:4326) and hit <code class="docutils literal notranslate"><span class="pre">OK</span></code>. The shapefile should be imported into PostGIS with no errors. Close the DB Manager and
get back to the main QGIS window.</p>
<p>Now load the SIDS data into the map using the ‘Add PostGIS Layer’
option. With a bit of rearranging of the layers and some colouring, you should be able to produce
a choropleth map of the sudden infant death syndrome counts (sid74 or sid79 fields) in North Carolina:</p>
<a class="reference internal image-reference" href="../../_images/postgis_sidsmap.png"><img alt="SIDS data mapped" class="align-center" src="../../_images/postgis_sidsmap.png" style="width: 1036.5px; height: 607.5px;" /></a>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Depending on the version of OSGeoLive you are using (ISO or VMDK), you will not find the same clients available.
<code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code> is the official client for PostgreSQL, however, for technical reasons, it can’t do in the ISO,
so it is only available in the VMDK version.
The ISO version has the <code class="docutils literal notranslate"><span class="pre">phpPgAdmin</span></code> client which offers the same core functionality.</p>
</div>
</section>
<section id="get-to-know-phppgadmin-iso-vmdk">
<h2><a class="toc-backref" href="#id8">Get to know phpPgAdmin (ISO &amp; VMDK)</a><a class="headerlink" href="#get-to-know-phppgadmin-iso-vmdk" title="Permalink to this headline">¶</a></h2>
<p>In both versions, you can use the graphical database client phpPgAdmin.</p>
<p>phpPgAdmin lets you use SQL to manipulate your data tables. You can find and launch phpPgAdmin
from the Databases folder, existing on the OSGeoLive Desktop.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadmin_main_window.png"><img alt="phpPgAdmin main" class="align-center" src="../../_images/postgis_phppgadmin_main_window.png" style="width: 396.0px; height: 227.0px;" /></a>
<p>Here, you have the option of creating a new connection to a PostgreSQL server, or connecting to an existing server.
The red “X” on the  <code class="docutils literal notranslate"><span class="pre">PostgreSQL</span></code> server denotes that you haven’t been yet connected.
Click on it  then enter the user name  <code class="docutils literal notranslate"><span class="pre">user</span></code> and the master password  <code class="docutils literal notranslate"><span class="pre">user</span></code>.</p>
<p>After connection established, you can see the list of the databases already existing in the system.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen0.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen0.png" style="width: 666.75px; height: 353.25px;" /></a>
<p>At this point you are able only to see the existing databases on the system. You can connect, by clicking,
on plus sign at the left of the name of a database. Do it for the <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code> database.</p>
<p>You can see now that there is only one schema in this database called
<code class="docutils literal notranslate"><span class="pre">public</span></code>.
Click on the plus at left of <code class="docutils literal notranslate"><span class="pre">Tables</span></code> to expand it, you can see all the tables
contained within this schema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen1.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen1.png" style="width: 848.25px; height: 538.5px;" /></a>
</section>
<section id="executing-a-sql-query-from-phppgadmin-iso-vmdk">
<h2><a class="toc-backref" href="#id9">Executing a SQL query from phpPgAdmin (ISO &amp; VMDK)</a><a class="headerlink" href="#executing-a-sql-query-from-phppgadmin-iso-vmdk" title="Permalink to this headline">¶</a></h2>
<p>phpPgAdmin offers the capability of executing queries to a relational database.</p>
<p>To perform a query on the database, click back on the <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code> database then press the <code class="docutils literal notranslate"><span class="pre">SQL</span></code> button from the main toolbar (the one at the left with the database symbol).</p>
<p>We are going to find the rate of the SIDS over the births for the 1974 for each city.
Furthermore we are going to sort the result, based on the computed rate. To do that, we need to perform the following query (submit it
on the text editor of the SQL Window):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">sid74</span><span class="o">/</span><span class="n">bir74</span> <span class="k">as</span> <span class="n">rate</span> <span class="kn">from</span> <span class="nn">sids</span> <span class="n">order</span> <span class="n">by</span> <span class="n">rate</span><span class="p">;</span>
</pre></div>
</div>
<p>Afterwards, you should press the Execute button.</p>
<a class="reference internal image-reference" href="../../_images/postgis_phppgadminscreen2.png"><img alt="phpPgAdmin" class="align-center" src="../../_images/postgis_phppgadminscreen2.png" style="width: 634.5px; height: 536.25px;" /></a>
</section>
<section id="get-to-know-pgadmin-vmdk-only">
<h2><a class="toc-backref" href="#id10">Get to know pgAdmin (VMDK only)</a><a class="headerlink" href="#get-to-know-pgadmin-vmdk-only" title="Permalink to this headline">¶</a></h2>
<p>You can use the graphical database client <code class="docutils literal notranslate"><span class="pre">pgAdmin</span></code> from the Databases menu to query and modify your database non-spatially. This is the official client for PostgreSQL.</p>
<p>pgAdmin lets you use SQL to manipulate your data tables. You can find and launch pgAdmin
from the Databases folder, existing on the OSGeoLive Desktop.</p>
<a class="reference internal image-reference" href="../../_images/postgis_pgadmin_main_window.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_pgadmin_main_window.png" style="width: 574.5px; height: 319.5px;" /></a>
<p>Enter the master password  <code class="docutils literal notranslate"><span class="pre">user</span></code>.</p>
<p>Here, you have the option of creating a new connection to a PostgreSQL server, or connecting to an existing server.
In this case, we are going to connect to the predefined <code class="docutils literal notranslate"><span class="pre">localhost</span></code> server.</p>
<p>After connection established, you can see the list of the databases already existing in the system.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen0.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen0.png" style="width: 871.5px; height: 639.0px;" /></a>
<p>The red “X” on the image of most of the databases, denotes that you haven’t been yet connected to any of them (you are connected only
to the default <code class="docutils literal notranslate"><span class="pre">postgres</span></code> database).
At this point you are able only to see the existing databases on the system. You can connect, by double clicking,
on the name of a database. Do it for the <code class="docutils literal notranslate"><span class="pre">natural_earth2</span></code> database.</p>
<p>You can see now that the red X disappeared and a “&gt;” appeared on the left. By pressing it a tree is going to appear,
displaying the contents of the database.</p>
<p>Navigate at the <code class="docutils literal notranslate"><span class="pre">schemas</span></code> subtree, expand it. Afterwards expand the
<code class="docutils literal notranslate"><span class="pre">public</span></code> schema. By navigating and expanding the
<code class="docutils literal notranslate"><span class="pre">Tables</span></code>, you can see all the tables contained within this schema.</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen1.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen1.png" style="width: 711.0px; height: 629.25px;" /></a>
</section>
<section id="executing-a-sql-query-from-pgadmin-vmdk-only">
<h2><a class="toc-backref" href="#id11">Executing a SQL query from pgAdmin (VMDK only)</a><a class="headerlink" href="#executing-a-sql-query-from-pgadmin-vmdk-only" title="Permalink to this headline">¶</a></h2>
<p>pgAdmin, offers the capability of executing queries to a relational database.</p>
<p>To perform a query on the database, you have to press the <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">Tool</span></code> button from the main toolbar (the one at the left with the database symbol).</p>
<p>We are going to find the rate of the SIDS over the births for the 1974 for each city.
Furthermore we are going to sort the result, based on the computed rate. To do that, we need to perform the following query (submit it
on the text editor of the SQL Window):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">name</span><span class="p">,</span> <span class="mi">1000</span><span class="o">*</span><span class="n">sid74</span><span class="o">/</span><span class="n">bir74</span> <span class="k">as</span> <span class="n">rate</span> <span class="kn">from</span> <span class="nn">sids</span> <span class="n">order</span> <span class="n">by</span> <span class="n">rate</span><span class="p">;</span>
</pre></div>
</div>
<p>Afterwards, you should press the arrow button, pointing to the right (Execute).</p>
<a class="reference internal image-reference" href="../../_images/postgis_adminscreen2.png"><img alt="pgAdmin" class="align-center" src="../../_images/postgis_adminscreen2.png" style="width: 870.75px; height: 636.75px;" /></a>
</section>
<section id="get-to-know-foreign-data-wrappers-fdw">
<h2><a class="toc-backref" href="#id12">Get to know Foreign Data Wrappers (FDW)</a><a class="headerlink" href="#get-to-know-foreign-data-wrappers-fdw" title="Permalink to this headline">¶</a></h2>
<p>From you database you can access remote objects like tables from other PostgreSQL databases or connect to remote databases like Oracle, MySQL, MS SQL or CouchDB.
You also can connect via ODBC, connect to CSV, Geospatial Data and even to twitter.</p>
<p>You find a list of different FDW at:</p>
<blockquote>
<div><p><a class="reference external" href="https://wiki.postgresql.org/wiki/Foreign_data_wrappers">https://wiki.postgresql.org/wiki/Foreign_data_wrappers</a></p>
</div></blockquote>
<p>Let’s see how it works! The easiest way is to connect to a different PostgreSQL database.</p>
<p>Here are the steps:</p>
<p>First load the extension for the Foreign Data Wrapper that you want to use. For a connection to a different PostgreSQL database you need <code class="docutils literal notranslate"><span class="pre">postgres_fdw</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">postgres_fdw</span><span class="p">;</span>
</pre></div>
</div>
<p>Create a foreign Server that tells you where to find the data source that you want to connect</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
 <span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">postgres_fdw</span>
 <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">host</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span> <span class="s1">&#39;5432&#39;</span><span class="p">,</span> <span class="n">dbname</span> <span class="s1">&#39;osm_local&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Define the user that should be used when you connect to the foreign server</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">USER</span> <span class="n">MAPPING</span> <span class="n">FOR</span> <span class="n">user</span>
      <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
      <span class="n">OPTIONS</span> <span class="p">(</span><span class="n">user</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">password</span> <span class="s1">&#39;user&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now you can create a foreign table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">public</span>
  <span class="n">LIMIT</span> <span class="n">TO</span> <span class="p">(</span><span class="n">planet_osm_polygon</span><span class="p">,</span> <span class="n">planet_osm_point</span><span class="p">)</span> <span class="o">--</span> <span class="ow">or</span> <span class="n">EXCEPT</span>
  <span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_pg_server_osm_local</span>
  <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p>Find new tables in your database and have a look at the data from a foreign table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">planet_osm_polygon</span> <span class="n">limit</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="connect-to-a-remote-ogr-data-source-via-ogr-fdw">
<h2><a class="toc-backref" href="#id13">Connect to a remote OGR data source via ogr_fdw</a><a class="headerlink" href="#connect-to-a-remote-ogr-data-source-via-ogr-fdw" title="Permalink to this headline">¶</a></h2>
<p>The extension <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code> allows connection too several geodata formats like KML,
GeoPackage, WFS, GeoJSON, GPX, GML and more.</p>
<p>Read more about <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code>:</p>
<ul class="simple">
<li><p>Repository: <a class="reference external" href="https://github.com/pramsey/pgsql-ogr-fdw">https://github.com/pramsey/pgsql-ogr-fdw</a></p></li>
<li><p>New and improved: <a class="reference external" href="http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html">http://blog.cleverelephant.ca/2016/04/ogr-fdw-update.html</a></p></li>
</ul>
<p class="rubric">Install the extension <code class="docutils literal notranslate"><span class="pre">ogr_fdw</span></code> in your database.</p>
<p>On the database prompt type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">EXTENSION</span> <span class="n">ogr_fdw</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Inspect which formats are supported:</p>
<p>Open a terminal and search for ogr_fdw_info:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">locate</span> <span class="n">ogr_fdw_info</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mi">10</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">ogr_fdw_info</span> <span class="o">-</span><span class="n">f</span>
</pre></div>
</div>
<p>Results might look like these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Supported</span> <span class="n">Formats</span><span class="p">:</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;OGR_GRASS&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PCIDSK&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;netCDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;JP2OpenJPEG&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;PDF&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MBTiles&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;EEDA&quot;</span> <span class="p">(</span><span class="n">readonly</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;ESRI Shapefile&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">-&gt;</span> <span class="s2">&quot;MapInfo File&quot;</span> <span class="p">(</span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="p">)</span>
 <span class="o">....</span> <span class="n">many</span> <span class="n">more</span>
</pre></div>
</div>
<p class="rubric">Create a FDW to a WFS</p>
<p>Start Geoserver via <span class="menuselection">Geospatial ‣ Web Services ‣ GeoServer ‣  Start GeoServer</span></p>
<ul class="simple">
<li><p>Open GeoServer <a class="reference external" href="http://localhost:8082/geoserver/web/">http://localhost:8082/geoserver/web/</a></p></li>
<li><p>GeoServer WFS GetCapabilities <a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetCapabilities</a></p></li>
<li><p>GeoServer WFS DescribeFeatureType for topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;typename=topp:states</a></p></li>
<li><p>GeoServer WFS GetFeature topp:states
<a class="reference external" href="http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states">http://localhost:8082/geoserver/ows?service=wfs&amp;version=2.0.0&amp;request=GetFeature&amp;typename=topp:states</a></p></li>
</ul>
<p class="rubric">Create a foreign server that refers to the WFS that you want to connect</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
<span class="n">FOREIGN</span> <span class="n">DATA</span> <span class="n">WRAPPER</span> <span class="n">ogr_fdw</span>
<span class="n">OPTIONS</span> <span class="p">(</span> <span class="n">datasource</span> <span class="s1">&#39;WFS:http://localhost:8082/geoserver/ows&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="s1">&#39;WFS&#39;</span> <span class="p">);</span>
</pre></div>
</div>
<p class="rubric">Import all WFS feature_types as foreign tables with one command.</p>
<p>After the import you will see several new foreign tables in your schema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IMPORT</span> <span class="n">FOREIGN</span> <span class="n">SCHEMA</span> <span class="n">ogr_all</span>
<span class="n">FROM</span> <span class="n">SERVER</span> <span class="n">fdw_ogr_server_wfs</span>
   <span class="n">INTO</span> <span class="n">public</span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Inspect the foreign data table <code class="docutils literal notranslate"><span class="pre">topp_states</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">topp_states</span> <span class="n">WHERE</span> <span class="n">state_name</span> <span class="o">=</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="things-to-try">
<h2><a class="toc-backref" href="#id14">Things to try</a><a class="headerlink" href="#things-to-try" title="Permalink to this headline">¶</a></h2>
<p>Here are some additional challenges for you to try:</p>
<ul class="simple">
<li><p>Try some more spatial functions like <code class="docutils literal notranslate"><span class="pre">st_buffer(geom)</span></code>, <code class="docutils literal notranslate"><span class="pre">st_transform(geom,25831)</span></code>, <code class="docutils literal notranslate"><span class="pre">st_x(geom)</span></code> - you will find full documentation at <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></p></li>
<li><p>Export your tables to shapefiles with <code class="docutils literal notranslate"><span class="pre">pgsql2shp</span></code> on the command line.</p></li>
<li><p>Try <code class="docutils literal notranslate"><span class="pre">ogr2ogr</span></code> on the command line to import/export data to your database.</p></li>
<li><p>Try to import data with <code class="docutils literal notranslate"><span class="pre">shp2pgsql</span></code> on the command line to your database.</p></li>
<li><p>Try to do road routing using <a class="reference internal" href="../overview/pgrouting_overview.html"><span class="doc">pgRouting</span></a>.</p></li>
</ul>
</section>
<section id="what-next">
<h2><a class="toc-backref" href="#id15">What next?</a><a class="headerlink" href="#what-next" title="Permalink to this headline">¶</a></h2>
<p>This is only the first step on the road to using PostGIS. There is a lot more functionality you can try.</p>
<ul class="simple">
<li><p>PostGIS Project home -  <a class="reference external" href="http://postgis.net">http://postgis.net</a></p></li>
<li><p>PostGIS Documentation -  <a class="reference external" href="http://postgis.net/documentation/">http://postgis.net/documentation/</a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    
    <div class="related">
	<font size="-2">
		<div id="translations">
		<!-- alphabetical order -->
              <a href="javascript:defaultRedirect('en')">English</a> |   <a href="javascript:defaultRedirect('de')">Deutsch</a> |   <a href="javascript:defaultRedirect('es')">Español</a> |   <a href="javascript:defaultRedirect('fi')">Suomen kieli</a> |   <a href="javascript:defaultRedirect('fr')">Français</a> |   <a href="javascript:defaultRedirect('hu')">Hungarian</a> |   <a href="javascript:defaultRedirect('it')">Italiano</a> |   <a href="javascript:defaultRedirect('ja')">日本語</a>
		</div>
	</font>
    </div>



        
        
<span style="font-size:85%;"><i><a href="../copyright.html">Copyright & Disclaimer</a></i></span>
        


  </body>
</html>